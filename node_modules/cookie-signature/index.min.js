function sha1(t){return crypto.createHash("sha1").update(t).digest("hex")}var crypto=require("crypto");exports.sign=function(t,e){if("string"!=typeof t)throw new TypeError("Cookie value must be provided as a string.");if("string"!=typeof e)throw new TypeError("Secret string must be provided.");return t+"."+crypto.createHmac("sha256",e).update(t).digest("base64").replace(/\=+$/,"")},exports.unsign=function(t,e){if("string"!=typeof t)throw new TypeError("Signed cookie string must be provided.");if("string"!=typeof e)throw new TypeError("Secret string must be provided.");var n=t.slice(0,t.lastIndexOf(".")),r=exports.sign(n,e);return sha1(r)==sha1(t)?n:!1};