function StreamCipher(t,e,n,r){return this instanceof StreamCipher?(Transform.call(this),this._cipher=new aes.AES(e),this._prev=new Buffer(n.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=r,n.copy(this._prev),void(this._mode=t)):new StreamCipher(t,e,n)}var aes=require("./aes"),Transform=require("cipher-base"),inherits=require("inherits");inherits(StreamCipher,Transform),module.exports=StreamCipher,StreamCipher.prototype._update=function(t){return this._mode.encrypt(this,t,this._decrypt)},StreamCipher.prototype._final=function(){this._cipher.scrub()};