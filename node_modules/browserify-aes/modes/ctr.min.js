function incr32(e){for(var r,t=e.length;t--;){if(r=e.readUInt8(t),255!==r){r++,e.writeUInt8(r,t);break}e.writeUInt8(0,t)}}function getBlock(e){var t=e._cipher.encryptBlock(e._prev);return incr32(e._prev),t}var xor=require("buffer-xor");exports.encrypt=function(e,t){for(;e._cache.length<t.length;)e._cache=Buffer.concat([e._cache,getBlock(e)]);var r=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),xor(t,r)};