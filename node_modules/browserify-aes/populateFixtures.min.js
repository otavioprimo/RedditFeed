var modes=require("./modes"),fixtures=require("./test/fixtures.json"),crypto=require("crypto"),types=["aes-128-cfb1","aes-192-cfb1","aes-256-cfb1"],ebtk=require("./EVP_BytesToKey"),fs=require("fs");fixtures.forEach(function(t){types.forEach(function(e){var n=crypto.createCipher(e,new Buffer(t.password)),r=new Buffer("");if(r=Buffer.concat([r,n.update(new Buffer(t.text))]),r=Buffer.concat([r,n["final"]()]),t.results.ciphers[e]=r.toString("hex"),"ECB"!==modes[e].mode){var i=crypto.createCipheriv(e,ebtk(crypto,t.password,modes[e].key).key,new Buffer(t.iv,"hex")),o=new Buffer("");o=Buffer.concat([o,i.update(new Buffer(t.text))]),o=Buffer.concat([o,i["final"]()]),t.results.cipherivs[e]=o.toString("hex")}})}),fs.writeFileSync("./test/fixturesNew.json",JSON.stringify(fixtures,!1,4));