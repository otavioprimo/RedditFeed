"use strict";function uglifyjs(e,t){e=config_1.generateContext(e),t=config_1.getUserConfigFile(e,taskInfo,t);var r=new logger_1.Logger("uglifyjs");return worker_client_1.runWorker("uglifyjs","uglifyjsWorker",e,t).then(function(){r.finish()})["catch"](function(e){throw r.fail(e)})}function uglifyjsWorker(e,t){return new Promise(function(r,n){try{var i=config_1.fillConfigDefaults(t,taskInfo.defaultConfigFile);i.sourceFile=path_1.join(e.buildDir,i.sourceFile),i.inSourceMap=path_1.join(e.buildDir,i.inSourceMap),i.destFileName=path_1.join(e.buildDir,i.destFileName);var o=path_1.join(e.buildDir,i.outSourceMap),a=runUglifyInternal(i),s=[helpers_1.writeFileAsync(i.destFileName,a.code),helpers_1.writeFileAsync(o,a.map)];return Promise.all(s).then(function(){r()})}catch(u){n(new errors_1.BuildError(u))}})}function runUglifyInternal(e){return uglify.minify(e.sourceFile,{compress:e.compress,mangle:e.mangle,outSourceMap:e.outSourceMap})}var errors_1=require("./util/errors"),config_1=require("./util/config"),path_1=require("path"),logger_1=require("./logger/logger"),worker_client_1=require("./worker-client"),helpers_1=require("./util/helpers"),uglify=require("uglify-js");exports.uglifyjs=uglifyjs,exports.uglifyjsWorker=uglifyjsWorker;var taskInfo={fullArg:"--uglifyjs",shortArg:"-u",envVar:"IONIC_UGLIFYJS",packageConfig:"ionic_uglifyjs",defaultConfigFile:"uglifyjs.config"};