"use strict";function timePrefix(){var e=new Date;return"["+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)+":"+("0"+e.getSeconds()).slice(-2)+"]"}function memoryUsage(){return chalk.dim(" MEM: "+(process.memoryUsage().rss/1e6).toFixed(1)+"MB")}var errors_1=require("../util/errors"),config_1=require("../util/config"),chalk=require("chalk"),Logger=function(){function e(t){this.start=Date.now(),this.scope=t;var r=t+" started "+chalk.dim("...");config_1.isDebugMode()&&(r+=memoryUsage()),e.info(r)}return e.prototype.ready=function(e,t){this.completed("ready",e,t)},e.prototype.finish=function(e,t){this.completed("finished",e,t)},e.prototype.completed=function(t,r,n){var o,i=Date.now()-this.start;if(i>1e3)o="in "+(i/1e3).toFixed(2)+" s";else{var s=parseFloat(i.toFixed(3));o=s>0?"in "+i+" ms":"in less than 1 ms"}var a=this.scope+" "+t;r&&(a=chalk[r](a)),n&&(a=chalk.bold(a)),a+=" "+chalk.dim(o),config_1.isDebugMode()&&(a+=memoryUsage()),e.info(a)},e.prototype.fail=function(t){if(t){if(t instanceof errors_1.IgnorableError)return;if(t instanceof errors_1.BuildError){var r=this.scope+" failed";return t.message&&(r+=": "+t.message),t.hasBeenLogged?config_1.isDebugMode()&&e.debug(""+r):(e.error(""+r),t.hasBeenLogged=!0,t.stack&&config_1.isDebugMode()&&e.debug(t.stack)),t}}return t},e.prototype.setStartTime=function(e){this.start=e},e.log=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];e.wordWrap(t).forEach(function(e){console.log(e)})},e.info=function(t,r,n){var i=e.wordWrap([t]);if(i.length){var o=timePrefix(),s=i[0].substr(o.length);r&&(s=chalk[r](s)),n&&(s=chalk.bold(s)),i[0]=chalk.dim(o)+s}i.forEach(function(e,t){t>0&&(r&&(e=chalk[r](e)),n&&(e=chalk.bold(e))),console.log(e)})},e.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];var n=e.wordWrap(t);if(n.length){var i=timePrefix();n[0]=i+n[0].substr(i.length)}n.forEach(function(e){console.warn(chalk.yellow(e))})},e.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];var n=e.wordWrap(t);if(n.length){var i=timePrefix();n[0]=i+n[0].substr(i.length),config_1.isDebugMode()&&(n[0]+=memoryUsage())}n.forEach(function(e){console.error(chalk.red(e))})},e.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];if(config_1.isDebugMode()){t.push(memoryUsage());var n=e.wordWrap(t);if(n.length){var i="[ DEBUG! ]";n[0]=i+n[0].substr(i.length)}n.forEach(function(e){console.log(chalk.cyan(e))})}},e.wordWrap=function(t){var r=[],n=[];t.forEach(function(e){null===e?n.push("null"):"undefined"==typeof e?n.push("undefined"):"string"==typeof e?e.replace(/\s/gm," ").split(" ").forEach(function(e){e.trim().length&&n.push(e.trim())}):"number"==typeof e||"boolean"==typeof e?n.push(e.toString()):"function"==typeof e?n.push(e.toString()):Array.isArray(e)?n.push(function(){return e.toString()}):Object(e)===e?n.push(function(){return e.toString()}):n.push(e.toString())});var i=e.INDENT;return n.forEach(function(t){"function"==typeof t?(i.trim().length&&r.push(i),r.push(t()),i=e.INDENT):e.INDENT.length+t.length>e.MAX_LEN?(i.trim().length&&r.push(i),r.push(e.INDENT+t),i=e.INDENT):t.length+i.length>e.MAX_LEN?(r.push(i),i=e.INDENT+t+" "):i+=t+" "}),i.trim().length&&r.push(i),r},e.formatFileName=function(e,t){return t=t.replace(e,""),/\/|\\/.test(t.charAt(0))&&(t=t.substr(1)),t.length>80&&(t="..."+t.substr(t.length-80)),t},e.formatHeader=function(t,r,n,i,o){void 0===i&&(i=null),void 0===o&&(o=null);var s=t+": "+e.formatFileName(n,r);return null!==i&&i>0&&(s+=null!==o&&o>i?", lines: "+i+" - "+o:", line: "+i),s},e.newLine=function(){console.log("")},e.INDENT="            ",e.MAX_LEN=120,e}();exports.Logger=Logger;