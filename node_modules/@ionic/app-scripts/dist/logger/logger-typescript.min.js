"use strict";function runTypeScriptDiagnostics(e,t){return t.map(function(t){return loadDiagnostic(e,t)})}function loadDiagnostic(e,t){var r={level:"error",type:"typescript",language:"typescript",header:"typescript error",code:t.code.toString(),messageText:ts.flattenDiagnosticMessageText(t.messageText,"\n"),relFileName:null,absFileName:null,lines:[]};if(t.file){r.absFileName=t.file.fileName,r.relFileName=logger_1.Logger.formatFileName(e.rootDir,r.absFileName);var n=t.file.getText(),i=helpers_1.splitLineBreaks(n),o=i;try{o=helpers_1.splitLineBreaks(highlight_1.highlight(r.language,n,!0).value)}catch(s){}var a=t.file.getLineAndCharacterOfPosition(t.start),u={lineIndex:a.line,lineNumber:a.line+1,text:i[a.line],html:o[a.line],errorCharStart:a.character,errorLength:Math.max(t.length,1)};if(-1===u.html.indexOf('class="hljs'))try{u.html=highlight_1.highlight(r.language,u.text,!0).value}catch(s){}if(r.lines.push(u),0===u.errorLength&&u.errorCharStart>0&&(u.errorLength=1,u.errorCharStart--),r.header=logger_1.Logger.formatHeader("typescript",t.file.fileName,e.rootDir,u.lineNumber),u.lineIndex>0){var c={lineIndex:u.lineIndex-1,lineNumber:u.lineNumber-1,text:i[u.lineIndex-1],html:o[u.lineIndex-1],errorCharStart:-1,errorLength:-1};if(-1===c.html.indexOf('class="hljs'))try{c.html=highlight_1.highlight(r.language,c.text,!0).value}catch(s){}r.lines.unshift(c)}if(u.lineIndex+1<i.length){var l={lineIndex:u.lineIndex+1,lineNumber:u.lineNumber+1,text:i[u.lineIndex+1],html:o[u.lineIndex+1],errorCharStart:-1,errorLength:-1};if(-1===l.html.indexOf('class="hljs'))try{l.html=highlight_1.highlight(r.language,l.text,!0).value}catch(s){}r.lines.push(l)}}return r}var logger_1=require("./logger"),highlight_1=require("../highlight/highlight"),helpers_1=require("../util/helpers"),ts=require("typescript");exports.runTypeScriptDiagnostics=runTypeScriptDiagnostics;