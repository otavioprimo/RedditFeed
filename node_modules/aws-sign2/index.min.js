function authorization(t){return"AWS "+t.key+":"+sign(t)}function hmacSha1(t){return crypto.createHmac("sha1",t.secret).update(t.message).digest("base64")}function sign(t){return t.message=stringToSign(t),hmacSha1(t)}function signQuery(t){return t.message=queryStringToSign(t),hmacSha1(t)}function stringToSign(t){var e=t.amazonHeaders||"";e&&(e+="\n");var n=[t.verb,t.md5,t.contentType,t.date?t.date.toUTCString():"",e+t.resource];return n.join("\n")}function queryStringToSign(t){return"GET\n\n\n"+t.date+"\n"+t.resource}function canonicalizeHeaders(t){for(var e=[],n=Object.keys(t),r=0,i=n.length;i>r;++r){var o=n[r],s=t[o],o=o.toLowerCase();0===o.indexOf("x-amz")&&e.push(o+":"+s)}return e.sort().join("\n")}function canonicalizeResource(t){var e=parse(t,!0),n=e.pathname,r=[];return Object.keys(e.query).forEach(function(t){if(~keys.indexOf(t)){var n=""==e.query[t]?"":"="+encodeURIComponent(e.query[t]);r.push(t+n)}}),n+(r.length?"?"+r.sort().join("&"):"")}var crypto=require("crypto"),parse=require("url").parse,keys=["acl","location","logging","notification","partNumber","policy","requestPayment","torrent","uploadId","uploads","versionId","versioning","versions","website"];module.exports=authorization,module.exports.authorization=authorization,module.exports.hmacSha1=hmacSha1,module.exports.sign=sign,module.exports.signQuery=signQuery,module.exports.queryStringToSign=stringToSign,module.exports.queryStringToSign=queryStringToSign,module.exports.canonicalizeHeaders=canonicalizeHeaders,module.exports.canonicalizeResource=canonicalizeResource;