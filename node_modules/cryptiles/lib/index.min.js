var Crypto=require("crypto"),Boom=require("boom"),internals={};exports.randomString=function(e){var t=exports.randomBits(6*(e+1));if(t instanceof Error)return t;var r=t.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return r.slice(0,e)},exports.randomBits=function(e){if(!e||0>e)return Boom.internal("Invalid random bits count");var t=Math.ceil(e/8);try{return Crypto.randomBytes(t)}catch(r){return Boom.internal("Failed generating random bits: "+r.message)}},exports.fixedTimeComparison=function(e,t){if("string"!=typeof e||"string"!=typeof t)return!1;var r=e.length===t.length?0:1;r&&(t=e);for(var n=0,i=e.length;i>n;++n){var a=e.charCodeAt(n),o=t.charCodeAt(n);r|=a^o}return 0===r};