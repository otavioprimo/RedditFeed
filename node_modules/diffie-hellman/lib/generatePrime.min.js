function _getPrimes(){if(null!==primes)return primes;var e=1048576,t=[];t[0]=2;for(var r=1,n=3;e>n;n+=2){for(var i=Math.ceil(Math.sqrt(n)),a=0;r>a&&t[a]<=i&&n%t[a]!==0;a++);r!==a&&t[a]<=i||(t[r++]=n)}return primes=t,t}function simpleSieve(e){for(var t=_getPrimes(),r=0;r<t.length;r++)if(0===e.modn(t[r]))return 0===e.cmpn(t[r])?!0:!1;return!0}function fermatTest(e){var t=BN.mont(e);return 0===TWO.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function findPrime(e,t){if(16>e)return new BN(2===t||5===t?[140,123]:[140,39]);t=new BN(t);for(var r,n;;){for(r=new BN(randomBytes(Math.ceil(e/8)));r.bitLength()>e;)r.ishrn(1);if(r.isEven()&&r.iadd(ONE),r.testn(1)||r.iadd(TWO),t.cmp(TWO)){if(!t.cmp(FIVE))for(;r.mod(TEN).cmp(THREE);)r.iadd(FOUR)}else for(;r.mod(TWENTYFOUR).cmp(ELEVEN);)r.iadd(FOUR);if(n=r.shrn(1),simpleSieve(n)&&simpleSieve(r)&&fermatTest(n)&&fermatTest(r)&&millerRabin.test(n)&&millerRabin.test(r))return r}}var randomBytes=require("randombytes");module.exports=findPrime,findPrime.simpleSieve=simpleSieve,findPrime.fermatTest=fermatTest;var BN=require("bn.js"),TWENTYFOUR=new BN(24),MillerRabin=require("miller-rabin"),millerRabin=new MillerRabin,ONE=new BN(1),TWO=new BN(2),FIVE=new BN(5),SIXTEEN=new BN(16),EIGHT=new BN(8),TEN=new BN(10),THREE=new BN(3),SEVEN=new BN(7),ELEVEN=new BN(11),FOUR=new BN(4),TWELVE=new BN(12),primes=null;