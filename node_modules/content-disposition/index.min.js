"use strict";function contentDisposition(t,e){var n=e||{},r=n.type||"attachment",i=createparams(t,n.fallback);return format(new ContentDisposition(r,i))}function createparams(t,e){if(void 0!==t){var n={};if("string"!=typeof t)throw new TypeError("filename must be a string");if(void 0===e&&(e=!0),"string"!=typeof e&&"boolean"!=typeof e)throw new TypeError("fallback must be a string or boolean");if("string"==typeof e&&nonLatin1RegExp.test(e))throw new TypeError("fallback must be ISO-8859-1 string");var r=basename(t),i=textRegExp.test(r),o="string"!=typeof e?e&&getlatin1(r):basename(e),s="string"==typeof o&&o!==r;return(s||!i||hexEscapeRegExp.test(r))&&(n["filename*"]=r),(i||s)&&(n.filename=s?o:r),n}}function format(t){var e=t.parameters,n=t.type;if(!n||"string"!=typeof n||!tokenRegExp.test(n))throw new TypeError("invalid type");var r=String(n).toLowerCase();if(e&&"object"==typeof e)for(var i,o=Object.keys(e).sort(),s=0;s<o.length;s++){i=o[s];var a="*"===i.substr(-1)?ustring(e[i]):qstring(e[i]);r+="; "+i+"="+a}return r}function decodefield(t){var e=extValueRegExp.exec(t);if(!e)throw new TypeError("invalid extended field value");var i,n=e[1].toLowerCase(),r=e[2],o=r.replace(hexEscapeReplaceRegExp,pdecode);switch(n){case"iso-8859-1":i=getlatin1(o);break;case"utf-8":i=new Buffer(o,"binary").toString("utf8");break;default:throw new TypeError("unsupported charset in extended field")}return i}function getlatin1(t){return String(t).replace(nonLatin1RegExp,"?")}function parse(t){if(!t||"string"!=typeof t)throw new TypeError("argument string is required");var e=dispositionTypeRegExp.exec(t);if(!e)throw new TypeError("invalid type format");var i,a,n=e[0].length,r=e[1].toLowerCase(),o=[],s={};for(n=paramRegExp.lastIndex=";"===e[0].substr(-1)?n-1:n;e=paramRegExp.exec(t);){if(e.index!==n)throw new TypeError("invalid parameter format");if(n+=e[0].length,i=e[1].toLowerCase(),a=e[2],-1!==o.indexOf(i))throw new TypeError("invalid duplicate parameter");o.push(i),i.indexOf("*")+1!==i.length?"string"!=typeof s[i]&&('"'===a[0]&&(a=a.substr(1,a.length-2).replace(qescRegExp,"$1")),s[i]=a):(i=i.slice(0,-1),a=decodefield(a),s[i]=a)}if(-1!==n&&n!==t.length)throw new TypeError("invalid parameter format");return new ContentDisposition(r,s)}function pdecode(t,e){return String.fromCharCode(parseInt(e,16))}function pencode(t){var e=String(t).charCodeAt(0).toString(16).toUpperCase();return 1===e.length?"%0"+e:"%"+e}function qstring(t){var e=String(t);return'"'+e.replace(quoteRegExp,"\\$1")+'"'}function ustring(t){var e=String(t),n=encodeURIComponent(e).replace(encodeUriAttrCharRegExp,pencode);return"UTF-8''"+n}function ContentDisposition(t,e){this.type=t,this.parameters=e}module.exports=contentDisposition,module.exports.parse=parse;var basename=require("path").basename,encodeUriAttrCharRegExp=/[\x00-\x20"'\(\)*,\/:;<=>?@\[\\\]\{\}\x7f]/g,hexEscapeRegExp=/%[0-9A-Fa-f]{2}/,hexEscapeReplaceRegExp=/%([0-9A-Fa-f]{2})/g,nonLatin1RegExp=/[^\x20-\x7e\xa0-\xff]/g,qescRegExp=/\\([\u0000-\u007f])/g,quoteRegExp=/([\\"])/g,paramRegExp=/; *([!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+) *= *("(?:[ !\x23-\x5b\x5d-\x7e\x80-\xff]|\\[\x20-\x7e])*"|[!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+) */g,textRegExp=/^[\x20-\x7e\x80-\xff]+$/,tokenRegExp=/^[!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+$/,extValueRegExp=/^([A-Za-z0-9!#$%&+\-^_`{}~]+)'(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3}|[A-Za-z]{4,8}|)'((?:%[0-9A-Fa-f]{2}|[A-Za-z0-9!#$&+\-\.^_`|~])+)$/,dispositionTypeRegExp=/^([!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+) *(?:$|;)/;