"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function structuredPatch(e,t,r,n,i,a,o){function u(e){return e.map(function(e){return" "+e})}o||(o={context:4});var s=_line.diffLines(r,n);s.push({value:"",lines:[]});for(var l=[],c=0,f=0,p=[],h=1,d=1,v=function(e){var t=s[e],i=t.lines||t.value.replace(/\n$/,"").split("\n");if(t.lines=i,t.added||t.removed){var a;if(!c){var v=s[e-1];c=h,f=d,v&&(p=o.context>0?u(v.lines.slice(-o.context)):[],c-=p.length,f-=p.length)}(a=p).push.apply(a,_toConsumableArray(i.map(function(e){return(t.added?"+":"-")+e}))),t.added?d+=i.length:h+=i.length}else{if(c)if(i.length<=2*o.context&&e<s.length-2){var m;(m=p).push.apply(m,_toConsumableArray(u(i)))}else{var g,y=Math.min(i.length,o.context);(g=p).push.apply(g,_toConsumableArray(u(i.slice(0,y))));var b={oldStart:c,oldLines:h-c+y,newStart:f,newLines:d-f+y,lines:p};if(e>=s.length-2&&i.length<=o.context){var _=/\n$/.test(r),w=/\n$/.test(n);0!=i.length||_?_&&w||p.push("\\ No newline at end of file"):p.splice(b.oldLines,0,"\\ No newline at end of file")}l.push(b),c=0,f=0,p=[]}h+=i.length,d+=i.length}},m=0;m<s.length;m++)v(m);return{oldFileName:e,newFileName:t,oldHeader:i,newHeader:a,hunks:l}}function createTwoFilesPatch(e,t,r,n,i,a,o){var s=structuredPatch(e,t,r,n,i,a,o),u=[];e==t&&u.push("Index: "+e),u.push("==================================================================="),u.push("--- "+s.oldFileName+("undefined"==typeof s.oldHeader?"":"	"+s.oldHeader)),u.push("+++ "+s.newFileName+("undefined"==typeof s.newHeader?"":"	"+s.newHeader));for(var l=0;l<s.hunks.length;l++){var c=s.hunks[l];u.push("@@ -"+c.oldStart+","+c.oldLines+" +"+c.newStart+","+c.newLines+" @@"),u.push.apply(u,c.lines)}return u.join("\n")+"\n"}function createPatch(e,t,r,n,i,a){return createTwoFilesPatch(e,e,t,r,n,i,a)}exports.__esModule=!0,exports.structuredPatch=structuredPatch,exports.createTwoFilesPatch=createTwoFilesPatch,exports.createPatch=createPatch;var _line=require("../diff/line");