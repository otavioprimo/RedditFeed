"use strict";var test=require("tap").test,util=require("util"),stream=require("readable-stream"),TrackerStream=require("../index.js").TrackerStream,testEvent=require("./lib/test-event.js"),Sink=function(){stream.Writable.apply(this,arguments)};util.inherits(Sink,stream.Writable),Sink.prototype._write=function(e,t,r){r()},test("TrackerStream",function(e){function i(n,i){e.is(n,null,"write: on change event fired"),e.is(i,t,"write: on change emits the correct name"),e.is(r.completed(),1,"write: 100% completed"),testEvent(r,"change",o),r.addWork(10)}function o(t,n){e.is(t,null,"addWork: on change event fired"),e.is(r.completed(),.5,"addWork: 50% completed"),testEvent(r,"change",s),r.write("ABCDEFGHIJKLMNOPQRST")}function s(t){e.is(t,null,"allWork: on change event fired"),e.is(r.completed(),1,"allWork: 100% completed")}e.plan(9);var t="test",r=new TrackerStream(t);e.is(r.completed(),0,"Nothing todo is 0 completion");var n=10;r=new TrackerStream(t,n),e.is(r.completed(),0,"Nothing done is 0 completion"),r.pipe(new Sink),testEvent(r,"change",i),r.write("0123456789")});