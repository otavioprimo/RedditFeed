"use strict";var IDENTIFIER=/^[a-z_$][a-z0-9_$]*$/i,customRuleCode=require("./dotjs/custom");module.exports=function(e,t){function u(e,t,n){for(var i,o=0;o<r.RULES.length;o++){var s=r.RULES[o];if(s.type==t){i=s;break}}i||(i={type:t,rules:[]},r.RULES.push(i));var a={keyword:e,definition:n,custom:!0,code:customRuleCode};i.rules.push(a),r.RULES.custom[e]=a}function l(e){if(!r.RULES.types[e])throw new Error("Unknown type "+e)}var r=this;if(this.RULES.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!IDENTIFIER.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){var n=t.type;if(Array.isArray(n)){var i,o=n.length;for(i=0;o>i;i++)l(n[i]);for(i=0;o>i;i++)u(e,n[i],t)}else n&&l(n),u(e,n,t);var s=t.$data===!0&&this._opts.v5;if(s&&!t.validate)throw new Error('$data support: neither "validate" nor "compile" functions are defined');var a=t.metaSchema;a&&(s&&(a={anyOf:[a,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json#/definitions/$data"}]}),t.validateSchema=r.compile(a,!0))}this.RULES.keywords[e]=this.RULES.all[e]=!0};