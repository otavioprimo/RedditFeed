"use strict";module.exports=function(e,t){var l,r=" ",n=e.level,i=e.dataLevel,o=e.schema[t],s=e.schemaPath+"."+t,a=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(i||""),p="valid"+n,f="errs__"+n,h=e.util.copy(e),d="";h.level++;var v="key"+n,m=h.dataLevel=e.dataLevel+1,g="data"+m,y=Object.keys(o||{}),_=e.schema.patternProperties||{},b=Object.keys(_),w=e.schema.additionalProperties,x=y.length||b.length,E=w===!1,C="object"==typeof w&&Object.keys(w).length,S=e.opts.removeAdditional,A=E||C||S,k=e.opts.ownProperties,P=e.baseId,T=e.schema.required;if(T&&(!e.opts.v5||!T.$data)&&T.length<e.opts.loopRequired)var O=e.util.toHash(T);if(e.opts.v5)var N=e.schema.patternGroups||{},M=Object.keys(N);if(r+="var "+f+" = errors;var valid"+h.level+" = true;",A){if(r+=" for (var "+v+" in "+c+") {  ",k&&(r+=" if (!Object.prototype.hasOwnProperty.call("+c+", "+v+")) continue; "),x){if(r+=" var isAdditional"+n+" = !(false ",y.length)if(y.length>5)r+=" || validate.schema"+s+"["+v+"] ";else{var I=y;if(I)for(var D,R=-1,L=I.length-1;L>R;)D=I[R+=1],r+=" || "+v+" == "+e.util.toQuotedString(D)+" "}if(b.length){var j=b;if(j)for(var F,V=-1,B=j.length-1;B>V;)F=j[V+=1],r+=" || "+e.usePattern(F)+".test("+v+") "}if(e.opts.v5&&M&&M.length){var q=M;if(q)for(var U,V=-1,H=q.length-1;H>V;)U=q[V+=1],r+=" || "+e.usePattern(U)+".test("+v+") "}r+=" ); if (isAdditional"+n+") { "}if("all"==S)r+=" delete "+c+"["+v+"]; ";else{var W=e.errorPath,z="' + key"+n+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,"key"+n,e.opts.jsonPointers)),E)if(S)r+=" delete "+c+"["+v+"]; ";else{r+=" valid"+h.level+" = false; ";var G=a;a=e.errSchemaPath+"/additionalProperties";var K=K||[];K.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(l||"additionalProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(a)+" , params: { additionalProperty: '"+z+"' } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have additional properties' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var Q=r;r=K.pop(),r+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a=G,u&&(r+=" break; ")}else if(C)if("failing"==S){r+=" var "+f+" = errors;  ";var J=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=w,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,"key"+n,e.opts.jsonPointers);var X=c+"[key"+n+"]";h.dataPathArr[m]="key"+n;var Y=e.validate(h);h.baseId=P,r+=e.util.varOccurences(Y,g)<2?" "+e.util.varReplace(Y,g,X)+" ":" var "+g+" = "+X+"; "+Y+" ",r+=" if (!valid"+h.level+") { errors = "+f+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+c+"["+v+"]; }  ",e.compositeRule=h.compositeRule=J}else{h.schema=w,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,"key"+n,e.opts.jsonPointers);var X=c+"[key"+n+"]";h.dataPathArr[m]="key"+n;var Y=e.validate(h);h.baseId=P,r+=e.util.varOccurences(Y,g)<2?" "+e.util.varReplace(Y,g,X)+" ":" var "+g+" = "+X+"; "+Y+" ",u&&(r+=" if (!valid"+h.level+") break; ")}e.errorPath=W}x&&(r+=" } "),r+=" }  ",u&&(r+=" if (valid"+h.level+") { ",d+="}")}var Z=e.opts.useDefaults&&!e.compositeRule;if(y.length){var $=y;if($)for(var D,ee=-1,te=$.length-1;te>ee;){D=$[ee+=1];var re=o[D];if(e.util.schemaHasRules(re,e.RULES.all)){var ne=e.util.getProperty(D),X=c+ne,ie=Z&&void 0!==re["default"];h.schema=re,h.schemaPath=s+ne,h.errSchemaPath=a+"/"+e.util.escapeFragment(D),h.errorPath=e.util.getPath(e.errorPath,D,e.opts.jsonPointers),h.dataPathArr[m]=e.util.toQuotedString(D);var Y=e.validate(h);if(h.baseId=P,e.util.varOccurences(Y,g)<2){Y=e.util.varReplace(Y,g,X);var oe=X}else{var oe=g;r+=" var "+g+" = "+X+"; "}if(ie)r+=" "+Y+" ";else{if(O&&O[D]){r+=" if ("+oe+" === undefined) { valid"+h.level+" = false; ";var W=e.errorPath,G=a,se=e.util.escapeQuotes(D);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(W,D,e.opts.jsonPointers)),a=e.errSchemaPath+"/required";var K=K||[];K.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(l||"required")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(a)+" , params: { missingProperty: '"+se+"' } ",e.opts.messages!==!1&&(r+=" , message: '",r+=e.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+se+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var Q=r;r=K.pop(),r+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a=G,e.errorPath=W,r+=" } else { "}else r+=u?" if ("+oe+" === undefined) { valid"+h.level+" = true; } else { ":" if ("+oe+" !== undefined) { ";r+=" "+Y+" } "}}u&&(r+=" if (valid"+h.level+") { ",d+="}")}}var ae=b;if(ae)for(var F,ue=-1,le=ae.length-1;le>ue;){F=ae[ue+=1];var re=_[F];if(e.util.schemaHasRules(re,e.RULES.all)){h.schema=re,h.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(F),h.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(F),r+=" for (var "+v+" in "+c+") {  ",k&&(r+=" if (!Object.prototype.hasOwnProperty.call("+c+", "+v+")) continue; "),r+=" if ("+e.usePattern(F)+".test("+v+")) { ",h.errorPath=e.util.getPathExpr(e.errorPath,"key"+n,e.opts.jsonPointers);var X=c+"[key"+n+"]";h.dataPathArr[m]="key"+n;var Y=e.validate(h);h.baseId=P,r+=e.util.varOccurences(Y,g)<2?" "+e.util.varReplace(Y,g,X)+" ":" var "+g+" = "+X+"; "+Y+" ",u&&(r+=" if (!valid"+h.level+") break; "),r+=" } ",u&&(r+=" else valid"+h.level+" = true; "),r+=" }  ",u&&(r+=" if (valid"+h.level+") { ",d+="}")}}if(e.opts.v5){var ce=M;if(ce)for(var U,pe=-1,fe=ce.length-1;fe>pe;){U=ce[pe+=1];var he=N[U],re=he.schema;if(e.util.schemaHasRules(re,e.RULES.all)){h.schema=re,h.schemaPath=e.schemaPath+".patternGroups"+e.util.getProperty(U)+".schema",h.errSchemaPath=e.errSchemaPath+"/patternGroups/"+e.util.escapeFragment(U)+"/schema",r+=" var pgPropCount"+n+" = 0; for (var "+v+" in "+c+") {  ",k&&(r+=" if (!Object.prototype.hasOwnProperty.call("+c+", "+v+")) continue; "),r+=" if ("+e.usePattern(U)+".test("+v+")) { pgPropCount"+n+"++; ",h.errorPath=e.util.getPathExpr(e.errorPath,"key"+n,e.opts.jsonPointers);var X=c+"[key"+n+"]";h.dataPathArr[m]="key"+n;var Y=e.validate(h);h.baseId=P,r+=e.util.varOccurences(Y,g)<2?" "+e.util.varReplace(Y,g,X)+" ":" var "+g+" = "+X+"; "+Y+" ",u&&(r+=" if (!valid"+h.level+") break; "),r+=" } ",u&&(r+=" else valid"+h.level+" = true; "),r+=" }  ",u&&(r+=" if (valid"+h.level+") { ",d+="}");var de=he.minimum,ve=he.maximum;if(void 0!==de||void 0!==ve){r+=" var "+p+" = true; ";var G=a;if(void 0!==de){var me=de,ge="minimum",ye="less";r+=" "+p+" = pgPropCount"+n+" >= "+de+"; ",a=e.errSchemaPath+"/patternGroups/minimum",r+="  if (!"+p+") {   ";var K=K||[];K.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(l||"patternGroups")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(a)+" , params: { reason: '"+ge+"', limit: "+me+", pattern: '"+e.util.escapeQuotes(U)+"' } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have "+ye+" than "+me+' properties matching pattern "'+e.util.escapeQuotes(U)+"\"' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var Q=r;r=K.pop(),r+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",void 0!==ve&&(r+=" else ")}if(void 0!==ve){var me=ve,ge="maximum",ye="more";r+=" "+p+" = pgPropCount"+n+" <= "+ve+"; ",a=e.errSchemaPath+"/patternGroups/maximum",r+="  if (!"+p+") {   ";var K=K||[];K.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(l||"patternGroups")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(a)+" , params: { reason: '"+ge+"', limit: "+me+", pattern: '"+e.util.escapeQuotes(U)+"' } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have "+ye+" than "+me+' properties matching pattern "'+e.util.escapeQuotes(U)+"\"' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),r+=" } "):r+=" {} ";var Q=r;r=K.pop(),r+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } "}a=G,u&&(r+=" if ("+p+") { ",d+="}")}}}}return u&&(r+=" "+d+" if ("+f+" == errors) {"),r=e.util.cleanUpCode(r)};