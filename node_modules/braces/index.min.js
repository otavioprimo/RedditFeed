"use strict";function braces(t,e,n){if(""===t)return[];Array.isArray(e)||(n=e,e=[]);var r=n||{};e=e||[],"undefined"==typeof r.nodupes&&(r.nodupes=!0);var o,i=r.fn;"function"==typeof r&&(i=r,r={}),patternRe instanceof RegExp||(patternRe=patternRegex());var s=t.match(patternRe)||[],a=s[0];switch(a){case"\\,":return escapeCommas(t,e,r);case"\\.":return escapeDots(t,e,r);case"/.":return escapePaths(t,e,r);case" ":return splitWhitespace(t);case"{,}":return exponential(t,r,braces);case"{}":return emptyBraces(t,e,r);case"\\{":case"\\}":return escapeBraces(t,e,r);case"${":if(!/\{[^{]+\{/.test(t))return e.concat(t);o=!0,t=tokens.before(t,es6Regex())}braceRe instanceof RegExp||(braceRe=braceRegex());var c=braceRe.exec(t);if(null==c)return[t];var l=c[1],u=c[2];if(""===u)return[t];var h,p;if(-1!==u.indexOf(".."))h=expand(u,r,i)||u.split(","),p=h.length;else{if('"'===u[0]||"'"===u[0])return e.concat(t.split(/['"]/).join(""));if(h=u.split(","),r.makeRe)return braces(t.replace(l,wrap(h,"|")),r);p=h.length,1===p&&r.bash&&(h[0]=wrap(h[0],"\\"))}for(var _,f=h.length,d=0;f--;){var g=h[d++];if(/(\.[^.\/])/.test(g))return p>1?h:[t];if(_=splice(t,l,g),/\{[^{}]+?\}/.test(_))e=braces(_,e,r);else if(""!==_){if(r.nodupes&&-1!==e.indexOf(_))continue;e.push(o?tokens.after(_):_)}}return r.strict?filter(e,filterEmpty):e}function exponential(t,e,n){"function"==typeof e&&(n=e,e=null);var s,r=e||{},i="__ESC_EXP__",o=0,a=t.split("{,}");if(r.nodupes)return n(a.join(""),r);o=a.length-1,s=n(a.join(i),r);for(var c=s.length,l=[],u=0;c--;){var h=s[u++],p=h.indexOf(i);if(-1===p)l.push(h);else if(h=h.split("__ESC_EXP__").join(""),h&&r.nodupes!==!1)l.push(h);else{var f=Math.pow(2,o);l.push.apply(l,repeat(h,f))}}return l}function wrap(t,e){return"|"===e?"("+t.join(e)+")":","===e?"{"+t.join(e)+"}":"-"===e?"["+t.join(e)+"]":"\\"===e?"\\{"+t+"\\}":void 0}function emptyBraces(t,e,n){return braces(t.split("{}").join("\\{\\}"),e,n)}function filterEmpty(t){return!!t&&"\\"!==t}function splitWhitespace(t){for(var e=t.split(" "),n=e.length,r=[],i=0;n--;)r.push.apply(r,braces(e[i++]));return r}function escapeBraces(t,e,n){return/\{[^{]+\{/.test(t)?(t=t.split("\\{").join("__LT_BRACE__"),t=t.split("\\}").join("__RT_BRACE__"),map(braces(t,e,n),function(t){return t=t.split("__LT_BRACE__").join("{"),t.split("__RT_BRACE__").join("}")})):e.concat(t.split("\\").join(""))}function escapeDots(t,e,n){return/[^\\]\..+\\\./.test(t)?(t=t.split("\\.").join("__ESC_DOT__"),map(braces(t,e,n),function(t){return t.split("__ESC_DOT__").join(".")})):e.concat(t.split("\\").join(""))}function escapePaths(t,e,n){return t=t.split("/.").join("__ESC_PATH__"),map(braces(t,e,n),function(t){return t.split("__ESC_PATH__").join("/.")})}function escapeCommas(t,e,n){return/\w,/.test(t)?(t=t.split("\\,").join("__ESC_COMMA__"),map(braces(t,e,n),function(t){return t.split("__ESC_COMMA__").join(",")})):e.concat(t.split("\\").join(""))}function patternRegex(){return/\${|( (?=[{,}])|(?=[{,}]) )|{}|{,}|\\,(?=.*[{}])|\/\.(?=.*[{}])|\\\.(?={)|\\{|\\}/}function braceRegex(){return/.*(\\?\{([^}]+)\})/}function es6Regex(){return/\$\{([^}]+)\}/}function splice(t,e,n){var r=t.indexOf(e);return t.substr(0,r)+n+t.substr(r+e.length)}function map(t,e){if(null==t)return[];for(var n=t.length,r=new Array(n),i=-1;++i<n;)r[i]=e(t[i],i,t);return r}function filter(t,e){if(null==t)return[];if("function"!=typeof e)throw new TypeError("braces: filter expects a callback function.");for(var n=t.length,r=t.slice(),i=0;n--;)e(t[n],i++)||r.splice(n,1);return r}var expand=require("expand-range"),repeat=require("repeat-element"),tokens=require("preserve");module.exports=function(t,e){if("string"!=typeof t)throw new Error("braces expects a string");return braces(t,e)};var braceRe,patternRe;