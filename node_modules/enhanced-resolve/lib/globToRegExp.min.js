function globToRegExp(e){if(/^\(.+\)$/.test(e))return new RegExp(e.substr(1,e.length-2));var t=tokenize(e),r=createRoot(),n=t.map(r).join("");return new RegExp("^"+n+"$")}function tokenize(e){return e.split(/([@?+*]\(|\/\*\*\/|\*\*|[?*]|\[[\!\^]?(?:[^\]\\]|\\.)+\]|\{|,|\/|[|)}])/g).map(function(e){if(!e)return null;var t=SIMPLE_TOKENS[e];return t?{type:t}:"["===e[0]?"^"===e[1]||"!"===e[1]?{type:"inverted-char-set",value:e.substr(2,e.length-3)}:{type:"char-set",value:e.substr(1,e.length-2)}:{type:"string",value:e}}).filter(Boolean).concat({type:"end"})}function createRoot(){var e=[],t=createSeqment(),r=!0;return function(n){switch(n.type){case"or":return e.push(r),"(";case"comma":return e.length?(r=e[e.length-1],"|"):t({type:"string",value:","},r);case"closing-or":if(0===e.length)throw new Error("Unmatched '}'");return e.pop(),")";case"end":if(e.length)throw new Error("Unmatched '{'");return t(n,r);default:var i=t(n,r);return r=!1,i}}}function createSeqment(){var e=[],t=createSimple();return function(r,n){switch(r.type){case"one":case"one-many":case"zero-many":case"zero-one":return e.push(r.type),"(";case"seqment-sep":return e.length?"|":t({type:"string",value:"|"},n);case"closing-seqment":var i=e.pop();switch(i){case"one":return")";case"one-many":return")+";case"zero-many":return")*";case"zero-one":return")?"}case"end":if(e.length>0)throw new Error("Unmatched segment, missing ')'");return t(r,n);default:return t(r,n)}}}function createSimple(){return function(e,t){switch(e.type){case"path-sep":return"[\\\\/]+";case"any-path-seqments":return"[\\\\/]+(?:(.+)[\\\\/]+)?";case"any-path":return"(.*)";case"any-path-seqment":return t?"\\.[\\\\/]+(?:.*[\\\\/]+)?([^\\\\/]+)":"([^\\\\/]*)";case"any-char":return"[^\\\\/]";case"inverted-char-set":return"[^"+e.value+"]";case"char-set":return"["+e.value+"]";case"string":return e.value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");case"end":return"";default:throw new Error("Unsupported token '"+e.type+"'")}}}var SIMPLE_TOKENS={"@(":"one","?(":"zero-one","+(":"one-many","*(":"zero-many","|":"seqment-sep","/**/":"any-path-seqments","**":"any-path","*":"any-path-seqment","?":"any-char","{":"or","/":"path-sep",",":"comma",")":"closing-seqment","}":"closing-or"};exports.globToRegExp=globToRegExp;