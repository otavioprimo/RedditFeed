function Resolver(e){Tapable.call(this),this.fileSystem=e}var Tapable=require("tapable"),createInnerCallback=require("./createInnerCallback");module.exports=Resolver,Resolver.prototype=Object.create(Tapable.prototype),Resolver.prototype.constructor=Resolver,Resolver.prototype.resolveSync=function(e,t,r){var n,i,a=!1;if(this.resolve(e,t,r,function(e,t){n=e,i=t,a=!0}),!a)throw new Error("Cannot 'resolveSync' because the fileSystem is not sync. Use 'resolve'!");if(n)throw n;return i},Resolver.prototype.resolve=function(e,t,r,n){function c(e){u.push(e)}function f(){return u.join("\n")}function p(e,t){if(n.log)for(var r=0;r<u.length;r++)n.log(u[r]);if(e)return n(e);if(!t){var s=new Error("Can't "+l);return s.details=f(),s.missing=o,i.applyPlugins("no-resolve",a,s),n(s)}return n(null,t.path===!1?!1:t.path+(t.query||""),t)}if(3===arguments.length)throw new Error("Signature changed: context parameter added");var i=this,a={context:e,path:t,request:r},o=[],s=n.missing?{push:function(e){n.missing.push(e),o.push(e)}}:o,u=[],l="resolve '"+r+"' in '"+t+"'";return this.doResolve("resolve",a,l,createInnerCallback(p,{log:c,missing:s,stack:n.stack},null))},Resolver.prototype.doResolve=function(e,t,r,n){function u(a,s){return arguments.length>0?a?n(a):s?n(null,s):n():i.applyPluginsParallelBailResult1(e,t,createInnerCallback(l,{log:n.log,missing:n.missing,stack:o},r))}function l(a,s){return arguments.length>0?a?n(a):s?n(null,s):n():i.applyPluginsAsyncSeriesBailResult1("after-"+e,t,createInnerCallback(c,{log:n.log,missing:n.missing,stack:o},r&&"after "+r,!0))}function c(e,t){return arguments.length>0?e?n(e):t?n(null,t):n():n()}var i=this,a=e+": ("+t.path+") "+(t.request||"")+(t.query||"")+(t.directory?" directory":"")+(t.module?" module":""),o=[a];if(n.stack&&(o=n.stack.concat(o),n.stack.indexOf(a)>=0)){var s=new Error("Recursion in resolving\nStack:\n  "+o.join("\n  "));return s.recursion=!0,n.log&&n.log("abort resolving because of recursion"),n(s)}i.applyPlugins("resolve-step",e,t),i.applyPluginsAsyncSeriesBailResult1("before-"+e,t,createInnerCallback(u,{log:n.log,missing:n.missing,stack:o},r&&"before "+r,!0))},Resolver.prototype.parse=function(e){if(""===e)return null;var t={request:"",query:"",module:!1,directory:!1,file:!1},r=e.indexOf("?");return 0==r?t.query=e:r>0?(t.request=e.slice(0,r),t.query=e.slice(r)):t.request=e,t.request&&(t.module=this.isModule(t.request),(t.directory=this.isDirectory(t.request))&&(t.request=t.request.substr(0,t.request.length-1))),t};var notModuleRegExp=/^\.$|^\.[\\\/]|^\.\.$|^\.\.[\/\\]|^\/|^[A-Z]:[\\\/]/i;Resolver.prototype.isModule=function(e){return!notModuleRegExp.test(e)};var directoryRegExp=/[\/\\]$/i;Resolver.prototype.isDirectory=function(e){return directoryRegExp.test(e)};var memoryFsJoin=require("memory-fs/lib/join"),memoizedJoin={};Resolver.prototype.join=function(e,t){var r=e+"|$"+t;return memoizedJoin[r]||(memoizedJoin[r]=memoryFsJoin(e,t)),memoizedJoin[r]},Resolver.prototype.normalize=require("memory-fs/lib/normalize");