"use strict";function protocolToRepresentation(t){return":"===t.substr(-1)&&(t=t.slice(0,-1)),protocolToRepresentationMap[t]||t}function isGitHubShorthand(t){return/^[^:@%\/\s.-][^:@%\/\s]*[\/][^:@\s\/%]+(?:#.*)?$/.test(t)}function fixupUnqualifiedGist(t){var e=url.parse(t);return"gist:"===e.protocol&&e.host&&!e.path?e.protocol+"/"+e.host:t}function parseGitUrl(t){"string"!=typeof t&&(t=""+t);var e=t.match(/^([^@]+)@([^:]+):[\/]?((?:[^\/]+[\/])?[^\/]+?)(?:[.]git)?(#.*)?$/);return e?{protocol:"git+ssh:",slashes:!0,auth:e[1],host:e[2],port:null,hostname:e[2],hash:e[4],search:null,query:null,pathname:"/"+e[3],path:"/"+e[3],href:"git+ssh://"+e[1]+"@"+e[2]+"/"+e[3]+(e[4]||"")}:url.parse(t)}var url=require("url"),gitHosts=require("./git-host-info.js"),GitHost=module.exports=require("./git-host.js"),protocolToRepresentationMap={"git+ssh":"sshurl","git+https":"https",ssh:"sshurl",git:"git"},authProtocols={"git:":!0,"https:":!0,"git+https:":!0,"http:":!0,"git+http:":!0};module.exports.fromUrl=function(t){if(null!=t&&""!==t){var e=fixupUnqualifiedGist(isGitHubShorthand(t)?"github:"+t:t),n=parseGitUrl(e),r=Object.keys(gitHosts).map(function(t){var e=gitHosts[t],r=null;n.auth&&authProtocols[n.protocol]&&(r=decodeURIComponent(n.auth));var i=n.hash?decodeURIComponent(n.hash.substr(1)):null,o=null,s=null,a=null;if(n.protocol===t+":")o=decodeURIComponent(n.host),s=n.path&&decodeURIComponent(n.path.replace(/^[\/](.*?)(?:[.]git)?$/,"$1")),a="shortcut";else{if(n.host!==e.domain)return;if(!e.protocols_re.test(n.protocol))return;var c=e.pathmatch,l=n.path.match(c);if(!l)return;null!=l[1]&&(o=decodeURIComponent(l[1])),null!=l[2]&&(s=decodeURIComponent(l[2])),a=protocolToRepresentation(n.protocol)}return new GitHost(t,o,r,s,i,a)}).filter(function(t){return t});if(1===r.length)return r[0]}};