"use strict";function CBCState(e){assert.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}function instantiate(e){function t(t){e.call(this,t),this._cbcInit()}inherits(t,e);for(var r=Object.keys(proto),n=0;n<r.length;n++){var i=r[n];t.prototype[i]=proto[i]}return t.create=function(e){return new t(e)},t}var assert=require("minimalistic-assert"),inherits=require("inherits"),proto={};exports.instantiate=instantiate,proto._cbcInit=function(){var e=new CBCState(this.options.iv);this._cbcState=e},proto._update=function(e,t,r,n){var i=this._cbcState,a=this.constructor.super_.prototype,o=i.iv;if("encrypt"===this.type){for(var s=0;s<this.blockSize;s++)o[s]^=e[t+s];a._update.call(this,o,0,r,n);for(var s=0;s<this.blockSize;s++)o[s]=r[n+s]}else{a._update.call(this,e,t,r,n);for(var s=0;s<this.blockSize;s++)r[n+s]^=o[s];for(var s=0;s<this.blockSize;s++)o[s]=e[t+s]}};