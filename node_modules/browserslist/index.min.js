function uniq(t){for(var e=[],n=0;n<t.length;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}function BrowserslistError(t){this.name="BrowserslistError",this.message=t||"",Error.captureStackTrace&&Error.captureStackTrace(this,BrowserslistError)}function error(t){var e=new BrowserslistError(t);throw e.browserslist=!0,e}var caniuse=require("caniuse-db/data.json").agents,path=require("path"),fs=require("fs");BrowserslistError.prototype=Error.prototype;var normalize=function(t){return t.filter(function(t){return"string"==typeof t})},fillUsage=function(t,e,n){for(var r in n)t[e+" "+r]=n[r]},browserslist=function(t,e){if("undefined"==typeof e&&(e={}),"undefined"==typeof t||null===t)if(process.env.BROWSERSLIST)t=process.env.BROWSERSLIST;else if(e.config||process.env.BROWSERSLIST_CONFIG){var n=e.config||process.env.BROWSERSLIST_CONFIG;fs.existsSync(n)&&fs.statSync(n).isFile()?t=browserslist.parseConfig(fs.readFileSync(n)):error("Can't read "+n+" config")}else{var r=browserslist.readConfig(e.path);t=r!==!1?r:browserslist.defaults}if("string"==typeof t&&(t=t.split(/,\s*/)),e.stats||process.env.BROWSERSLIST_STATS){browserslist.usage.custom={};var i=e.stats||process.env.BROWSERSLIST_STATS;if("string"==typeof i)try{i=JSON.parse(fs.readFileSync(i))}catch(o){error("Can't read "+i)}"dataByBrowser"in i&&(i=i.dataByBrowser);for(var s in i)fillUsage(browserslist.usage.custom,s,i[s])}var c,l,u,h,p,a=[];return t.forEach(function(t){if(""!==t.trim()){c=!1,p=!1,0===t.indexOf("not ")&&(t=t.slice(4),c=!0);for(var e in browserslist.queries)if(l=browserslist.queries[e],u=t.match(l.regexp)){h=l.select.apply(browserslist,u.slice(1)),a=c?a.filter(function(t){return-1===h.indexOf(t)}):a.concat(h),p=!0;break}p||error("Unknown browser query `"+t+"`")}}),a=uniq(a),a.filter(function(t){var e=t.split(" ")[1];if("0"===e){var n=t.split(" ")[0];return!a.some(function(e){return e!==t&&e.split(" ")[0]===n})}return!0}).sort(function(t,e){if(t=t.split(" "),e=e.split(" "),t[0]===e[0]){var n=parseFloat(e[1])-parseFloat(t[1]);return n>0?1:0>n?-1:0}return t[0].localeCompare(e[0])})},normalizeVersion=function(t,e){return-1!==t.versions.indexOf(e)?e:browserslist.versionAliases[t.name][e]},loadCountryStatistics=function(t){if(!browserslist.usage[t]){var e={},n=require("caniuse-db/region-usage-json/"+t+".json");for(var r in n.data)fillUsage(e,r,n.data[r]);browserslist.usage[t]=e}};browserslist.data={},browserslist.usage={global:{},custom:null},browserslist.defaults=["> 1%","last 2 versions","Firefox ESR"],browserslist.major=["safari","opera","ios_saf","ie_mob","ie","edge","firefox","chrome"],browserslist.aliases={fx:"firefox",ff:"firefox",ios:"ios_saf",explorer:"ie",blackberry:"bb",explorermobile:"ie_mob",operamini:"op_mini",operamobile:"op_mob",chromeandroid:"and_chr",firefoxandroid:"and_ff",ucandroid:"and_uc"},browserslist.versionAliases={},browserslist.byName=function(t){return t=t.toLowerCase(),t=browserslist.aliases[t]||t,browserslist.data[t]},browserslist.checkName=function(t){var e=browserslist.byName(t);return e||error("Unknown browser "+t),e},browserslist.readConfig=function(t){if(t===!1)return!1;if(!fs.readFileSync||!fs.existsSync||!fs.statSync)return!1;"undefined"==typeof t&&(t=".");for(var n,e=path.resolve(t).split(path.sep);e.length;){if(n=e.concat(["browserslist"]).join(path.sep),fs.existsSync(n)&&fs.statSync(n).isFile())return browserslist.parseConfig(fs.readFileSync(n));e.pop()}return!1},browserslist.coverage=function(t,e){return e&&"global"!==e?(e=e.toUpperCase(),loadCountryStatistics(e)):e="global",t.reduce(function(t,n){var r=browserslist.usage[e][n];return void 0===r&&(r=browserslist.usage[e][n.replace(/ [\d.]+$/," 0")]),t+(r||0)},0)},browserslist.parseConfig=function(t){return t.toString().replace(/#[^\n]*/g,"").split(/\n/).map(function(t){return t.trim()}).filter(function(t){return""!==t})},browserslist.queries={lastVersions:{regexp:/^last\s+(\d+)\s+versions?$/i,select:function(t){var e=[];return browserslist.major.forEach(function(n){var r=browserslist.byName(n);if(r){var i=r.released.slice(-t);i=i.map(function(t){return r.name+" "+t}),e=e.concat(i)}}),e}},lastByBrowser:{regexp:/^last\s+(\d+)\s+(\w+)\s+versions?$/i,select:function(t,e){var n=browserslist.checkName(e);return n.released.slice(-t).map(function(t){return n.name+" "+t})}},globalStatistics:{regexp:/^>\s*(\d*\.?\d+)%$/,select:function(t){t=parseFloat(t);var e=[];for(var n in browserslist.usage.global)browserslist.usage.global[n]>t&&e.push(n);return e}},customStatistics:{regexp:/^>\s*(\d*\.?\d+)%\s+in\s+my\s+stats$/,select:function(t){t=parseFloat(t);var e=[],n=browserslist.usage.custom;n||error("Custom usage statistics was not provided");for(var r in n)n[r]>t&&e.push(r);return e}},countryStatistics:{regexp:/^>\s*(\d*\.?\d+)%\s+in\s+(\w\w)$/,select:function(t,e){t=parseFloat(t),e=e.toUpperCase();var n=[];loadCountryStatistics(e);var r=browserslist.usage[e];for(var i in r)r[i]>t&&n.push(i);return n}},range:{regexp:/^(\w+)\s+([\d\.]+)\s*-\s*([\d\.]+)$/i,select:function(t,e,n){var r=browserslist.checkName(t);e=parseFloat(normalizeVersion(r,e)||e),n=parseFloat(normalizeVersion(r,n)||n);var i=function(t){var r=parseFloat(t);return r>=e&&n>=r};return r.released.filter(i).map(function(t){return r.name+" "+t})}},versions:{regexp:/^(\w+)\s*(>=?|<=?)\s*([\d\.]+)$/,select:function(t,e,n){var r=browserslist.checkName(t),i=normalizeVersion(r,n);i&&(n=i),n=parseFloat(n);var o;return">"===e?o=function(t){return parseFloat(t)>n}:">="===e?o=function(t){return parseFloat(t)>=n}:"<"===e?o=function(t){return parseFloat(t)<n}:"<="===e&&(o=function(t){return parseFloat(t)<=n}),r.released.filter(o).map(function(t){return r.name+" "+t})}},esr:{regexp:/^(firefox|ff|fx)\s+esr$/i,select:function(){return["firefox 45"]}},opMini:{regexp:/(operamini|op_mini)\s+all/i,select:function(){return["op_mini all"]}},direct:{regexp:/^(\w+)\s+(tp|[\d\.]+)$/i,select:function(t,e){/tp/i.test(e)&&(e="TP");var n=browserslist.checkName(t),r=normalizeVersion(n,e);return r?e=r:(-1===e.indexOf(".")?r=e+".0":/\.0$/.test(e)&&(r=e.replace(/\.0$/,"")),r=normalizeVersion(n,r),r?e=r:error("Unknown version "+e+" of "+t)),[n.name+" "+e]}}},function(){for(var t in caniuse){browserslist.data[t]={name:t,versions:normalize(caniuse[t].versions),released:normalize(caniuse[t].versions.slice(0,-3))},fillUsage(browserslist.usage.global,t,caniuse[t].usage_global),browserslist.versionAliases[t]={};for(var e=0;e<caniuse[t].versions.length;e++)if(caniuse[t].versions[e]){var n=caniuse[t].versions[e];if(-1!==n.indexOf("-"))for(var r=n.split("-"),i=0;i<r.length;i++)browserslist.versionAliases[t][r[i]]=n}}}(),module.exports=browserslist;