function Zlib(e){if(e<exports.DEFLATE||e>exports.UNZIP)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function bufferSet(e,t){for(var r=0;r<e.length;r++)this[t+r]=e[r]}var msg=require("pako/lib/zlib/messages"),zstream=require("pako/lib/zlib/zstream"),zlib_deflate=require("pako/lib/zlib/deflate.js"),zlib_inflate=require("pako/lib/zlib/inflate.js"),constants=require("pako/lib/zlib/constants");for(var key in constants)exports[key]=constants[key];exports.NONE=0,exports.DEFLATE=1,exports.INFLATE=2,exports.GZIP=3,exports.GUNZIP=4,exports.DEFLATERAW=5,exports.INFLATERAW=6,exports.UNZIP=7,Zlib.prototype.init=function(e,t,r,n,i){switch(this.windowBits=e,this.level=t,this.memLevel=r,this.strategy=n,(this.mode===exports.GZIP||this.mode===exports.GUNZIP)&&(this.windowBits+=16),this.mode===exports.UNZIP&&(this.windowBits+=32),(this.mode===exports.DEFLATERAW||this.mode===exports.INFLATERAW)&&(this.windowBits=-this.windowBits),this.strm=new zstream,this.mode){case exports.DEFLATE:case exports.GZIP:case exports.DEFLATERAW:var o=zlib_deflate.deflateInit2(this.strm,this.level,exports.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case exports.INFLATE:case exports.GUNZIP:case exports.INFLATERAW:case exports.UNZIP:var o=zlib_inflate.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}return o!==exports.Z_OK?void this._error(o):(this.write_in_progress=!1,void(this.init_done=!0))},Zlib.prototype.params=function(){throw new Error("deflateParams Not supported")},Zlib.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(this.mode===exports.NONE)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},Zlib.prototype.write=function(e,t,r,n,i,o,a){this._writeCheck(),this.write_in_progress=!0;var s=this;return process.nextTick(function(){s.write_in_progress=!1;var u=s._write(e,t,r,n,i,o,a);s.callback(u[0],u[1]),s.pending_close&&s.close()}),this},Zlib.prototype.writeSync=function(e,t,r,n,i,o,a){return this._writeCheck(),this._write(e,t,r,n,i,o,a)},Zlib.prototype._write=function(e,t,r,n,i,o,a){if(this.write_in_progress=!0,e!==exports.Z_NO_FLUSH&&e!==exports.Z_PARTIAL_FLUSH&&e!==exports.Z_SYNC_FLUSH&&e!==exports.Z_FULL_FLUSH&&e!==exports.Z_FINISH&&e!==exports.Z_BLOCK)throw new Error("Invalid flush value");null==t&&(t=new Buffer(0),n=0,r=0),i._set?i.set=i._set:i.set=bufferSet;var s=this.strm;switch(s.avail_in=n,s.input=t,s.next_in=r,s.avail_out=a,s.output=i,s.next_out=o,this.mode){case exports.DEFLATE:case exports.GZIP:case exports.DEFLATERAW:var u=zlib_deflate.deflate(s,e);break;case exports.UNZIP:case exports.INFLATE:case exports.GUNZIP:case exports.INFLATERAW:var u=zlib_inflate.inflate(s,e);break;default:throw new Error("Unknown mode "+this.mode)}return u!==exports.Z_STREAM_END&&u!==exports.Z_OK&&this._error(u),this.write_in_progress=!1,[s.avail_in,s.avail_out]},Zlib.prototype.close=function(){return this.write_in_progress?void(this.pending_close=!0):(this.pending_close=!1,this.mode===exports.DEFLATE||this.mode===exports.GZIP||this.mode===exports.DEFLATERAW?zlib_deflate.deflateEnd(this.strm):zlib_inflate.inflateEnd(this.strm),void(this.mode=exports.NONE))},Zlib.prototype.reset=function(){switch(this.mode){case exports.DEFLATE:case exports.DEFLATERAW:var e=zlib_deflate.deflateReset(this.strm);break;case exports.INFLATE:case exports.INFLATERAW:var e=zlib_inflate.inflateReset(this.strm)}e!==exports.Z_OK&&this._error(e)},Zlib.prototype._error=function(e){this.onerror(msg[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()},exports.Zlib=Zlib;