!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/compiler"),require("@angular/core/testing")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/compiler","@angular/core/testing"],t):t((e.ng=e.ng||{},e.ng.compiler=e.ng.compiler||{},e.ng.compiler.testing=e.ng.compiler.testing||{}),e.ng.core,e.ng.compiler,e.ng.core.testing)}(this,function(e,t,r,n){"use strict";function o(e){return void 0!==e&&null!==e}function a(e){if("string"==typeof e)return e;if(void 0===e||null===e)return""+e;if(e.overriddenName)return e.overriddenName;if(e.name)return e.name;var t=e.toString(),r=t.indexOf("\n");return-1===r?t:t.substring(0,r)}function v(e,t,r){var n=new Set,i=function(e){var i=t[e];i instanceof Array?i.forEach(function(t){n.add(_(e,t,r))}):n.add(_(e,i,r))};for(var o in t)i(o);var a=function(t){var i=e[t];i instanceof Array?e[t]=i.filter(function(e){return!n.has(_(t,e,r))}):n.has(_(t,i,r))&&(e[t]=void 0)};for(var o in e)a(o)}function m(e,t){for(var r in t){var n=t[r],i=e[r];null!=i&&i instanceof Array?e[r]=i.concat(n):e[r]=n}}function g(e,t){for(var r in t)e[r]=t[r]}function _(e,t,r){var n=function(e,t){return"function"==typeof t&&(t=w(t,r)),t};return e+":"+JSON.stringify(t,n)}function w(e,t){var r=t.get(e);return r||(r=""+a(e)+y++,t.set(e,r)),r}function b(e){var t=[];Object.keys(e).forEach(function(e){e.startsWith("_")||t.push(e)});for(var r=e;r=Object.getPrototypeOf(r);)Object.keys(r).forEach(function(e){var n=Object.getOwnPropertyDescriptor(r,e);!e.startsWith("_")&&n&&"get"in n&&t.push(e)});return t}var i=function(){function e(e,t,r,n,i){this.existingProperties=e,this.attrPropMapping=t,this.existingElements=r,this.invalidProperties=n,this.invalidAttributes=i}return e.prototype.hasProperty=function(e,t,r){var n=this.existingProperties[t];return void 0===n?!0:n},e.prototype.hasElement=function(e,t){var r=this.existingElements[e.toLowerCase()];return void 0===r?!0:r},e.prototype.securityContext=function(e,r){return t.SecurityContext.NONE},e.prototype.getMappedPropName=function(e){return this.attrPropMapping[e]||e},e.prototype.getDefaultComponentElementName=function(){return"ng-component"},e.prototype.validateProperty=function(e){return this.invalidProperties.indexOf(e)>-1?{error:!0,msg:"Binding to property '"+e+"' is disallowed for security reasons"}:{error:!1}},e.prototype.validateAttribute=function(e){return this.invalidAttributes.indexOf(e)>-1?{error:!0,msg:"Binding to attribute '"+e+"' is disallowed for security reasons"}:{error:!1}},e}(),s=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},u=function(e){function r(t){e.call(this),this._injector=t,this._directives=new Map,this._providerOverrides=new Map,this._viewProviderOverrides=new Map,this._views=new Map,this._inlineTemplates=new Map,this._animations=new Map}return s(r,e),Object.defineProperty(r.prototype,"_compiler",{get:function(){return this._injector.get(t.Compiler)},enumerable:!0,configurable:!0}),r.prototype._clearCacheFor=function(e){this._compiler.clearCacheFor(e)},r.prototype.resolve=function(r,n){void 0===n&&(n=!0);var i=this._directives.get(r);if(i||(i=e.prototype.resolve.call(this,r,n)),!i)return null;var a=this._providerOverrides.get(r),s=this._viewProviderOverrides.get(r),u=i.providers;if(o(a)){var c=i.providers||[];u=c.concat(a)}if(i instanceof t.Component){var f=i.viewProviders;if(o(s)){var c=i.viewProviders||[];f=c.concat(s)}var l=this._views.get(r);l||(l=i);var p=l.animations,h=l.templateUrl,y=this._animations.get(r);o(y)&&(p=y);var d=this._inlineTemplates.get(r);return o(d)?h=null:d=l.template,new t.Component({selector:i.selector,inputs:i.inputs,outputs:i.outputs,host:i.host,exportAs:i.exportAs,moduleId:i.moduleId,queries:i.queries,changeDetection:i.changeDetection,providers:u,viewProviders:f,entryComponents:i.entryComponents,template:d,templateUrl:h,animations:p,styles:l.styles,styleUrls:l.styleUrls,encapsulation:l.encapsulation,interpolation:l.interpolation})}return new t.Directive({selector:i.selector,inputs:i.inputs,outputs:i.outputs,host:i.host,providers:u,exportAs:i.exportAs,queries:i.queries})},r.prototype.setDirective=function(e,t){this._directives.set(e,t),this._clearCacheFor(e)},r.prototype.setProvidersOverride=function(e,t){this._providerOverrides.set(e,t),this._clearCacheFor(e)},r.prototype.setViewProvidersOverride=function(e,t){this._viewProviderOverrides.set(e,t),this._clearCacheFor(e)},r.prototype.setView=function(e,t){this._views.set(e,t),this._clearCacheFor(e)},r.prototype.setInlineTemplate=function(e,t){this._inlineTemplates.set(e,t),this._clearCacheFor(e)},r.prototype.setAnimations=function(e,t){this._animations.set(e,t),this._clearCacheFor(e)},r.decorators=[{type:t.Injectable}],r.ctorParameters=[{type:t.Injector}],r}(r.DirectiveResolver),c=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},f=function(e){function r(t){e.call(this),this._injector=t,this._ngModules=new Map}return c(r,e),r.prototype.setNgModule=function(e,t){this._ngModules.set(e,t),this._clearCacheFor(e)},r.prototype.resolve=function(t,r){return void 0===r&&(r=!0),this._ngModules.get(t)||e.prototype.resolve.call(this,t,r)},Object.defineProperty(r.prototype,"_compiler",{get:function(){return this._injector.get(t.Compiler)},enumerable:!0,configurable:!0}),r.prototype._clearCacheFor=function(e){this._compiler.clearCacheFor(e)},r.decorators=[{type:t.Injectable}],r.ctorParameters=[{type:t.Injector}],r}(r.NgModuleResolver),l=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},p=function(e){function r(t){e.call(this),this._injector=t,this._pipes=new Map}return l(r,e),Object.defineProperty(r.prototype,"_compiler",{get:function(){return this._injector.get(t.Compiler)},enumerable:!0,configurable:!0}),r.prototype._clearCacheFor=function(e){this._compiler.clearCacheFor(e)},r.prototype.setPipe=function(e,t){this._pipes.set(e,t),this._clearCacheFor(e)},r.prototype.resolve=function(t,r){void 0===r&&(r=!0);var n=this._pipes.get(t);return n||(n=e.prototype.resolve.call(this,t,r)),n},r.decorators=[{type:t.Injectable}],r.ctorParameters=[{type:t.Injector}],r}(r.PipeResolver),h=n.__core_private_testing__.TestingCompilerFactory,y=0,d=function(){function e(){this._references=new Map}return e.prototype.overrideMetadata=function(e,t,r){var n={};if(t&&b(t).forEach(function(e){return n[e]=t[e]}),r.set){if(r.remove||r.add)throw new Error("Cannot set and add/remove "+a(e)+" at the same time!");g(n,r.set)}return r.remove&&v(n,r.remove,this._references),r.add&&m(n,r.add),new e(n)},e}(),O=function(){function e(e){this._compilerFactory=e}return e.prototype.createTestingCompiler=function(e){var t=this._compilerFactory.createCompiler(e);return new C(t,t.injector.get(u),t.injector.get(p),t.injector.get(f))},e.decorators=[{type:t.Injectable}],e.ctorParameters=[{type:t.CompilerFactory}],e}(),C=function(){function e(e,t,r,n){this._compiler=e,this._directiveResolver=t,this._pipeResolver=r,this._moduleResolver=n,this._overrider=new d}return Object.defineProperty(e.prototype,"injector",{get:function(){return this._compiler.injector},enumerable:!0,configurable:!0}),e.prototype.compileModuleSync=function(e){return this._compiler.compileModuleSync(e)},e.prototype.compileModuleAsync=function(e){return this._compiler.compileModuleAsync(e)},e.prototype.compileModuleAndAllComponentsSync=function(e){return this._compiler.compileModuleAndAllComponentsSync(e)},e.prototype.compileModuleAndAllComponentsAsync=function(e){return this._compiler.compileModuleAndAllComponentsAsync(e)},e.prototype.overrideModule=function(e,r){var n=this._moduleResolver.resolve(e,!1);this._moduleResolver.setNgModule(e,this._overrider.overrideMetadata(t.NgModule,n,r))},e.prototype.overrideDirective=function(e,r){var n=this._directiveResolver.resolve(e,!1);this._directiveResolver.setDirective(e,this._overrider.overrideMetadata(t.Directive,n,r))},e.prototype.overrideComponent=function(e,r){var n=this._directiveResolver.resolve(e,!1);this._directiveResolver.setDirective(e,this._overrider.overrideMetadata(t.Component,n,r))},e.prototype.overridePipe=function(e,r){var n=this._pipeResolver.resolve(e,!1);this._pipeResolver.setPipe(e,this._overrider.overrideMetadata(t.Pipe,n,r))},e.prototype.clearCache=function(){this._compiler.clearCache()},e.prototype.clearCacheFor=function(e){this._compiler.clearCacheFor(e)},e}(),P=t.createPlatformFactory(r.platformCoreDynamic,"coreDynamicTesting",[{provide:t.COMPILER_OPTIONS,useValue:{providers:[p,{provide:r.PipeResolver,useExisting:p},u,{provide:r.DirectiveResolver,useExisting:u},f,{provide:r.NgModuleResolver,useExisting:f}]},multi:!0},{provide:h,useClass:O}]);e.TestingCompilerFactoryImpl=O,e.TestingCompilerImpl=C,e.platformCoreDynamicTesting=P,e.MockSchemaRegistry=i,e.MockDirectiveResolver=u,e.MockNgModuleResolver=f,e.MockPipeResolver=p});