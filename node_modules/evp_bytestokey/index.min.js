function EVP_BytesToKey(t,e,n,r){Buffer.isBuffer(t)||(t=new Buffer(t,"binary")),e&&!Buffer.isBuffer(e)&&(e=new Buffer(e,"binary")),n/=8,r=r||0;for(var l,u,i=0,o=0,s=new Buffer(n),a=new Buffer(r),c=0,h=[];;){if(c++>0&&h.push(l),h.push(t),e&&h.push(e),l=md5(Buffer.concat(h)),h=[],u=0,n>0)for(;;){if(0===n)break;if(u===l.length)break;s[i++]=l[u],n--,u++}if(r>0&&u!==l.length)for(;;){if(0===r)break;if(u===l.length)break;a[o++]=l[u],r--,u++}if(0===n&&0===r)break}for(u=0;u<l.length;u++)l[u]=0;return{key:s,iv:a}}var md5=require("create-hash/md5");module.exports=EVP_BytesToKey;