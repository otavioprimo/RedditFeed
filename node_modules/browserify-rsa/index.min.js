function blind(t){var e=getr(t),n=e.toRed(bn.mont(t.modulus)).redPow(new bn(t.publicExponent)).fromRed();return{blinder:n,unblinder:e.invm(t.modulus)}}function crt(t,e){var n=blind(e),r=e.modulus.byteLength(),o=(bn.mont(e.modulus),new bn(t).mul(n.blinder).umod(e.modulus)),s=o.toRed(bn.mont(e.prime1)),a=o.toRed(bn.mont(e.prime2)),c=e.coefficient,l=e.prime1,u=e.prime2,h=s.redPow(e.exponent1),p=a.redPow(e.exponent2);h=h.fromRed(),p=p.fromRed();var f=h.isub(p).imul(c).umod(l);return f.imul(u),p.iadd(f),new Buffer(p.imul(n.unblinder).umod(e.modulus).toArray(!1,r))}function getr(t){for(var e=t.modulus.byteLength(),n=new bn(randomBytes(e));n.cmp(t.modulus)>=0||!n.umod(t.prime1)||!n.umod(t.prime2);)n=new bn(randomBytes(e));return n}var bn=require("bn.js"),randomBytes=require("randombytes");module.exports=crt,crt.getr=getr;