var test=require("tape"),algorithms=["sha1","sha224","sha256","sha384","sha512","SHA512","md5","rmd160"],formats=[void 0,"base64","hex","binary"],vectors=require("hash-test-vectors/hmac"),createHmac=require("./browser");algorithms.forEach(function(t){vectors.forEach(function(e){var n=new Buffer(e.key,"hex"),r=new Buffer(e.data,"hex");formats.forEach(function(i){test("hmac("+t+") w/ "+e.data.slice(0,6)+"... as "+i,function(o){var s=createHmac(t,n),a=i?r.toString(i):r;s.update(a,i);var c=s.digest(i),l=new Buffer(c,i),u=e.truncate?l.slice(0,e.truncate):l;o.equal(u.toString("hex"),e[t.toLowerCase()]),o.end()})})}),vectors.forEach(function(e){test("hmac("+t+") as stream w/ "+e.data.slice(0,6)+"...",function(n){var r=createHmac(t,new Buffer(e.key,"hex"));r.end(e.data,"hex");var i=r.read(),o=e.truncate?i.slice(0,e.truncate):i;n.equal(o.toString("hex"),e[t.toLowerCase()]),n.end()})})});