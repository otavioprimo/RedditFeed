function store(e,t){var r="string"==typeof e,n=r?e:e[0];n.indexOf("_")>-1&&(n=t.restore(n,prefixContentFrom(t.output))),track(n,r?null:e,t),t.output.push(n)}function prefixContentFrom(e){for(var t=[],r=e.length-1;r>=0;r--){var n=e[r];if(t.unshift(n),"{"==n||";"==n)break}return t.join("")}function track(e,t,r){t&&trackAllMappings(t,r);var n=e.split("\n");r.line+=n.length-1,r.column=n.length>1?0:r.column+n.pop().length}function trackAllMappings(e,t){var r=e[e.length-1];if(Array.isArray(r))for(var n=0,i=r.length;i>n;n++)trackMapping(r[n],t)}function trackMapping(e,t){var r=e[2]||unknownSource;isWindows&&(r=r.replace(/\\/g,"/")),t.outputMap.addMapping({generated:{line:t.line,column:t.column},source:r,original:{line:e[0],column:e[1]}}),e[3]&&t.outputMap.setSourceContent(r,e[3][e[2]])}function stringify(e,t,r,n){var i={column:0,inputMapTracker:n,keepBreaks:t.keepBreaks,line:1,output:[],outputMap:new SourceMapGenerator,restore:r,sourceMapInlineSources:t.sourceMapInlineSources,spaceAfterClosingBrace:t.compatibility.properties.spaceAfterClosingBrace,store:store};return all(e,i,!1),{sourceMap:i.outputMap,styles:i.output.join("").trim()}}var SourceMapGenerator=require("source-map").SourceMapGenerator,all=require("./helpers").all,isWindows="win32"==process.platform,unknownSource="$stdin";module.exports=stringify;