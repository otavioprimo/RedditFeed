function removeEmpty(e){for(var t=0,r=e.length;r>t;t++){var n=e[t],i=!1;switch(n[0]){case"selector":i=0===n[1].length||0===n[2].length;break;case"block":removeEmpty(n[2]),i=0===n[2].length}i&&(e.splice(t,1),t--,r--)}}function recursivelyOptimizeBlocks(e,t,r){for(var n=0,i=e.length;i>n;n++){var a=e[n];if("block"==a[0]){var o=/@(-moz-|-o-|-webkit-)?keyframes/.test(a[1][0]);optimize(a[2],t,r,!o)}}}function recursivelyOptimizeProperties(e,t,r){for(var n=0,i=e.length;i>n;n++){var a=e[n];switch(a[0]){case"selector":optimizeProperties(a[1],a[2],!1,!0,t,r);break;case"block":recursivelyOptimizeProperties(a[2],t,r)}}}function optimize(e,t,r,n){if(recursivelyOptimizeBlocks(e,t,r),recursivelyOptimizeProperties(e,t,r),removeDuplicates(e),mergeAdjacent(e,t,r),reduceNonAdjacent(e,t,r),mergeNonAdjacentBySelector(e,t,r),mergeNonAdjacentByBody(e,t),t.restructuring&&n&&(restructure(e,t),mergeAdjacent(e,t,r)),t.mediaMerging){removeDuplicateMediaQueries(e);for(var i=mergeMediaQueries(e),a=i.length-1;a>=0;a--)optimize(i[a][2],t,r,!1)}removeEmpty(e)}var optimizeProperties=require("../properties/optimizer"),removeDuplicates=require("./remove-duplicates"),mergeAdjacent=require("./merge-adjacent"),reduceNonAdjacent=require("./reduce-non-adjacent"),mergeNonAdjacentBySelector=require("./merge-non-adjacent-by-selector"),mergeNonAdjacentByBody=require("./merge-non-adjacent-by-body"),restructure=require("./restructure"),removeDuplicateMediaQueries=require("./remove-duplicate-media-queries"),mergeMediaQueries=require("./merge-media-queries");module.exports=optimize;