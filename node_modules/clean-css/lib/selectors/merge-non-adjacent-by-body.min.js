function unsafeSelector(e){return/\.|\*| :/.test(e)}function isBemElement(e){var t=stringifySelectors(e[1]);return t.indexOf("__")>-1||t.indexOf("--")>-1}function withoutModifier(e){return e.replace(/--[^ ,>\+~:]+/g,"")}function removeAnyUnsafeElements(e,t){var r=withoutModifier(stringifySelectors(e[1]));for(var n in t){var i=t[n],a=withoutModifier(stringifySelectors(i[1]));(a.indexOf(r)>-1||r.indexOf(a)>-1)&&delete t[n]}}function mergeNonAdjacentByBody(e,t){for(var r={},n=t.compatibility.selectors.adjacentSpace,i=e.length-1;i>=0;i--){var a=e[i];if("selector"==a[0]){a[2].length>0&&!t.semanticMerging&&unsafeSelector(stringifySelectors(a[1]))&&(r={}),a[2].length>0&&t.semanticMerging&&isBemElement(a)&&removeAnyUnsafeElements(a,r);var o=stringifyBody(a[2]),s=r[o];!s||isSpecial(t,stringifySelectors(a[1]))||isSpecial(t,stringifySelectors(s[1]))||(a[1]=a[2].length>0?cleanUpSelectors(s[1].concat(a[1]),!1,n):s[1].concat(a[1]),s[2]=[],r[o]=null),r[stringifyBody(a[2])]=a}}}var stringifyBody=require("../stringifier/one-time").body,stringifySelectors=require("../stringifier/one-time").selectors,cleanUpSelectors=require("./clean-up").selectors,isSpecial=require("./is-special");module.exports=mergeNonAdjacentByBody;