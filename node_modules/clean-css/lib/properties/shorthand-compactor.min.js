function mixedImportance(e){var t;for(var r in e){if(void 0!==t&&e[r].important!=t)return!0;t=e[r].important}return!1}function componentSourceMaps(e){var t=[];for(var r in e){var n=e[r],i=n.all[n.position],a=i[0][i[0].length-1];Array.isArray(a)&&Array.prototype.push.apply(t,a)}return t}function replaceWithShorthand(e,t,r,n,i){var s,a=compactable[r],o=[[r],[a.defaultValue]],u=wrapSingle(o);u.shorthand=!0,u.dirty=!0,populateComponents([u],i,[]);for(var l=0,c=a.components.length;c>l;l++){var f=t[a.components[l]],p=compactable[f.name].canOverride;if(hasInherit(f))return;if(!everyCombination(p,u.components[l],f,i))return;u.components[l]=deepClone(f),u.important=f.important,s=f.all}for(var h in t)t[h].unused=!0;if(n){var d=componentSourceMaps(t);d.length>0&&o[0].push(d)}u.position=s.length,u.all=s,u.all.push(o),e.push(u)}function invalidateOrCompact(e,t,r,n,i){var a=e[t];for(var o in r)if(void 0===a||o!=a.name){var s=compactable[o],u=r[o];s.components.length>Object.keys(u).length?delete r[o]:mixedImportance(u)||replaceWithShorthand(e,u,o,n,i)}}function compactShortands(e,t,r){var n={};if(!(e.length<3)){for(var i=0,a=e.length;a>i;i++){var o=e[i];if(!o.unused&&!o.hack&&!o.variable){var s=compactable[o.name];if(s&&s.componentOf)if(o.shorthand)invalidateOrCompact(e,i,n,t,r);else{var u=s.componentOf;n[u]=n[u]||{},n[u][o.name]=o}}}invalidateOrCompact(e,i,n,t,r)}}var compactable=require("./compactable"),deepClone=require("./clone").deep,hasInherit=require("./has-inherit"),populateComponents=require("./populate-components"),wrapSingle=require("./wrap-for-optimizing").single,everyCombination=require("./every-combination");module.exports=compactShortands;