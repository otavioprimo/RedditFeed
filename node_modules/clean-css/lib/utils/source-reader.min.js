function SourceReader(e,t){this.outerContext=e,this.data=t,this.sources={}}function fromString(e){var t=e.data;return e.trackSource(void 0,t),t}function fromBuffer(e){var t=e.data.toString();return e.trackSource(void 0,t),t}function fromArray(e){return e.data.map(function(t){return e.outerContext.options.processImport===!1?t+"@shallow":t}).map(function(t){return!e.outerContext.options.relativeTo||/^https?:\/\//.test(t)?t:path.relative(e.outerContext.options.relativeTo,t)}).map(function(e){return"@import url("+e+");"}).join("")}function fromHash(e){var t=[],r=path.resolve(e.outerContext.options.target||e.outerContext.options.root);for(var n in e.data){var i=e.data[n].styles,a=e.data[n].sourceMap,s=REMOTE_RESOURCE.test(n),o=s?n:path.resolve(n),u=path.dirname(o),l={absolute:e.outerContext.options.explicitRoot,relative:!e.outerContext.options.explicitRoot,imports:!0,rebase:e.outerContext.options.rebase,fromBase:u,toBase:s?u:r,urlQuotes:e.outerContext.options.compatibility.properties.urlQuotes};i=rewriteUrls(i,l,e.outerContext),e.trackSource(n,i),i=e.outerContext.sourceTracker.store(n,i),e.outerContext.options.sourceMap&&a&&e.outerContext.inputSourceMapTracker.trackLoaded(n,n,a),t.push(i)}return t.join("")}var path=require("path"),rewriteUrls=require("../urls/rewrite"),REMOTE_RESOURCE=/^(https?:)?\/\//;SourceReader.prototype.sourceAt=function(e){return this.sources[e]},SourceReader.prototype.trackSource=function(e,t){this.sources[e]={},this.sources[e][e]=t},SourceReader.prototype.toString=function(){return"string"==typeof this.data?fromString(this):Buffer.isBuffer(this.data)?fromBuffer(this):Array.isArray(this.data)?fromArray(this):fromHash(this)},module.exports=SourceReader;