function QuoteScanner(e){this.data=e}function findLastCommentStartedAt(e,t){for(var r=t;r>-1&&(r=e.lastIndexOf(COMMENT_START_MARK,r),!(r>-1&&"*"!=e[r-1]));)r--;return r}function findNext(e,t,r){for(var n="\\",i=r;;){if(i=e.indexOf(t,i+1),-1==i)return-1;if(e[i-1]!=n)return i}}var COMMENT_START_MARK="/*",findQuoteEnd=function(e,t,r,n){var i="*/",a="\\",s="}",o=e.substring(n,r),u=o.lastIndexOf(i,r),l=findLastCommentStartedAt(o,r),c=!1;if(u>=r&&l>-1&&(c=!0),r>l&&l>u&&(c=!0),c){var f=e.indexOf(i,r);return f>-1?f:(f=e.indexOf(s,r),f>-1?f-1:e.length)}for(;;){if(void 0===e[r])break;if(e[r]==t&&(e[r-1]!=a||e[r-2]==a))break;r++}return r};QuoteScanner.prototype.each=function(e){for(var t=this.data,r=[],n=0,i=0,a=0,s=null,o="'",u='"',l=t.length;i<t.length;){var c=findNext(t,o,i),f=findNext(t,u,i);if(-1==c&&(c=l),-1==f&&(f=l),f>c?(n=c,s=o):(n=f,s=u),-1==n)break;if(i=findQuoteEnd(t,s,n+1,a),-1==i)break;var p=t.substring(n,i+1);r.push(t.substring(a,n)),p.length>0&&e(p,r,n),a=i+1}return r.length>0?r.join("")+t.substring(a,t.length):t},module.exports=QuoteScanner;