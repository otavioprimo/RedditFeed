var test=require("tape"),DES=require("./"),modes=require("./modes"),crypto=require("crypto");Object.keys(modes).forEach(function(t){test(t,function(e){function r(n){e.test("run: "+n,function(e){e.plan(2);var o,n=crypto.randomBytes(modes[t].key),r=crypto.randomBytes(modes[t].iv),i=crypto.randomBytes(200);try{o=new DES({mode:t,key:n,iv:r})}catch(s){e.notOk(s,s.stack)}var a;try{a=crypto.createCipheriv(t,n,r)}catch(s){e.notOk(s,s.stack)}var c=Buffer.concat([o.update(i),o["final"]()]),l=Buffer.concat([a.update(i),a["final"]()]);e.equals(l.toString("hex"),c.toString("hex"));var u=new DES({mode:t,key:n,iv:r,decrypt:!0}),h=Buffer.concat([u.update(c),u["final"]()]);e.equals(i.toString("hex"),h.toString("hex"))})}for(var n=0;++n<10;)r(n)})});