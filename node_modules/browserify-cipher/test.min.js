function runIvTest(t,e,n){test("mode: "+t,function(r){function o(i){r.test("run: "+i,function(r){r.plan(2);var a,i=crypto.randomBytes(e),o=crypto.randomBytes(n),s=crypto.randomBytes(200);try{a=ourCrypto.createCipheriv(t,i,o)}catch(c){r.notOk(c,c.stack)}var l;try{l=crypto.createCipheriv(t,i,o)}catch(c){r.notOk(c,c.stack)}var h,u=Buffer.concat([a.update(s),a["final"]()]);"gcm"===t.slice(-3)&&(h=a.getAuthTag());var p=Buffer.concat([l.update(s),l["final"]()]);r.equals(p.toString("hex"),u.toString("hex"));var f=ourCrypto.createDecipheriv(t,i,o);"gcm"===t.slice(-3)&&f.setAuthTag(h);var d=Buffer.concat([f.update(u),f["final"]()]);r.equals(s.toString("hex"),d.toString("hex"))})}for(var i=0;++i<10;)o(i)})}var test=require("tape"),crypto=require("crypto"),desModes=require("browserify-des/modes"),aesModes=require("browserify-aes/modes"),ourCrypto=require("./browser");Object.keys(aesModes).forEach(function(t){var e=aesModes[t];runIvTest(t,e.key/8,e.iv)}),Object.keys(desModes).forEach(function(t){var e=desModes[t];runIvTest(t,e.key,e.iv)});