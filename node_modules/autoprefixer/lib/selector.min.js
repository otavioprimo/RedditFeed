(function(){var e,t,r,n,i,o=function(e,t){function n(){this.constructor=e}for(var r in t)a.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},a={}.hasOwnProperty;t=require("./old-selector"),r=require("./prefixer"),e=require("./browsers"),i=require("./utils"),n=function(r){function n(e,t,r){this.name=e,this.prefixes=t,this.all=r,this.regexpCache={}}return o(n,r),n.prototype.check=function(e){return-1!==e.selector.indexOf(this.name)?!!e.selector.match(this.regexp()):!1},n.prototype.prefixed=function(e){return this.name.replace(/^([^\w]*)/,"$1"+e)},n.prototype.regexp=function(e){var t;return this.regexpCache[e]?this.regexpCache[e]:(t=e?this.prefixed(e):this.name,this.regexpCache[e]=RegExp("(^|[^:\"'=])"+i.escapeRegexp(t),"gi"))},n.prototype.possible=function(){return e.prefixes()},n.prototype.prefixeds=function(e){var t,r,n,i,o;if(e._autoprefixerPrefixeds)return e._autoprefixerPrefixeds;for(i={},o=this.possible(),t=0,r=o.length;r>t;t++)n=o[t],i[n]=this.replace(e.selector,n);return e._autoprefixerPrefixeds=i},n.prototype.already=function(e,t,r){var n,i,o,a,s;for(i=e.parent.index(e)-1;i>=0;){if(n=e.parent.nodes[i],"rule"!==n.type)return!1;s=!1;for(o in t)if(a=t[o],n.selector===a){if(r===o)return!0;s=!0;break}if(!s)return!1;i-=1}return!1},n.prototype.replace=function(e,t){return e.replace(this.regexp(),"$1"+this.prefixed(t))},n.prototype.add=function(e,t){var r,n;return n=this.prefixeds(e),this.already(e,n,t)?void 0:(r=this.clone(e,{selector:n[t]}),e.parent.insertBefore(e,r))},n.prototype.old=function(e){return new t(this,e)},n}(r),module.exports=n}).call(this);