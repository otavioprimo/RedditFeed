(function(){var e,t,r,n,i,o,a,s,u=function(e,t){function n(){this.constructor=e}for(var r in t)l.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},l={}.hasOwnProperty,c=[].slice;t=require("../old-value"),r=require("../value"),s=require("../utils"),o=require("postcss-value-parser"),a=require("normalize-range"),i=require("postcss/lib/list"),n=/top|left|right|bottom/gi,e=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return u(r,e),r.names=["linear-gradient","repeating-linear-gradient","radial-gradient","repeating-radial-gradient"],r.prototype.replace=function(e,t){var r,n,i,a,s,u;for(r=o(e),u=r.nodes,i=0,a=u.length;a>i;i++)if(s=u[i],"function"===s.type&&s.value===this.name)if(s.nodes=this.newDirection(s.nodes),s.nodes=this.normalize(s.nodes),"-webkit- old"===t){if(n=this.oldWebkit(s),!n)return}else s.nodes=this.convertDirection(s.nodes),s.value=t+s.value;return r.toString()},r.prototype.directions={top:"bottom",left:"right",bottom:"top",right:"left"},r.prototype.oldDirections={top:"left bottom, left top",left:"right top, left top",bottom:"left top, left bottom",right:"left top, right top","top right":"left bottom, right top","top left":"right bottom, left top","right top":"left bottom, right top","right bottom":"left top, right bottom","bottom right":"left top, right bottom","bottom left":"right top, left bottom","left top":"right bottom, left top","left bottom":"right top, left bottom"},r.prototype.replaceFirst=function(){var e,t,r;return e=arguments[0],r=2<=arguments.length?c.call(arguments,1):[],t=r.map(function(e){return" "===e?{type:"space",value:e}:{type:"word",value:e}}),t.concat(e.slice(1))},r.prototype.normalizeUnit=function(e,t){var r,n;return n=parseFloat(e),r=n/t*360,r+"deg"},r.prototype.normalize=function(e){var t;return e[0]?(/-?\d+(.\d+)?grad/.test(e[0].value)?e[0].value=this.normalizeUnit(e[0].value,400):/-?\d+(.\d+)?rad/.test(e[0].value)?e[0].value=this.normalizeUnit(e[0].value,2*Math.PI):/-?\d+(.\d+)?turn/.test(e[0].value)?e[0].value=this.normalizeUnit(e[0].value,1):-1!==e[0].value.indexOf("deg")&&(t=parseFloat(e[0].value),t=a.wrap(0,360,t),e[0].value=t+"deg"),"0deg"===e[0].value?e=this.replaceFirst(e,"to"," ","top"):"90deg"===e[0].value?e=this.replaceFirst(e,"to"," ","right"):"180deg"===e[0].value?e=this.replaceFirst(e,"to"," ","bottom"):"270deg"===e[0].value&&(e=this.replaceFirst(e,"to"," ","left")),e):e},r.prototype.newDirection=function(e){var t,r,i;if("to"===e[0].value)return e;if(!n.test(e[0].value))return e;for(e.unshift({type:"word",value:"to"},{type:"space",value:" "}),t=r=2,i=e.length;(i>=2?i>r:r>i)&&"div"!==e[t].type;t=i>=2?++r:--r)"word"===e[t].type&&(e[t].value=this.revertDirection(e[t].value));return e},r.prototype.convertDirection=function(e){return e.length>0&&("to"===e[0].value?this.fixDirection(e):-1!==e[0].value.indexOf("deg")?this.fixAngle(e):"at"===e[2].value&&this.fixRadial(e)),e},r.prototype.fixDirection=function(e){var t,r,n,i;for(e.splice(0,2),i=[],t=r=0,n=e.length;(n>=0?n>r:r>n)&&"div"!==e[t].type;t=n>=0?++r:--r)"word"===e[t].type?i.push(e[t].value=this.revertDirection(e[t].value)):i.push(void 0);return i},r.prototype.fixAngle=function(e){var t;return t=e[0].value,t=parseFloat(t),t=Math.abs(450-t)%360,t=this.roundFloat(t,3),e[0].value=t+"deg"},r.prototype.fixRadial=function(e){var t,r,n,i,o;for(t=e[0],o=[],r=n=4,i=e.length;(i>=4?i>n:n>i)&&"div"!==e[r].type;r=i>=4?++n:--n)o.push(e[r]);return e.splice.apply(e,[0,r].concat(c.call(o),[e[r+2]],[t]))},r.prototype.revertDirection=function(e){return this.directions[e.toLowerCase()]||e},r.prototype.roundFloat=function(e,t){return parseFloat(e.toFixed(t))},r.prototype.oldWebkit=function(e){var t,r,n,i,a,s,u,l,c;if(s=e.nodes,c=o.stringify(e.nodes),"linear-gradient"!==this.name)return!1;if(s[0]&&-1!==s[0].value.indexOf("deg"))return!1;if(-1!==c.indexOf("px"))return!1;if(-1!==c.indexOf("-corner"))return!1;if(-1!==c.indexOf("-side"))return!1;for(l=[[]],r=0,i=s.length;i>r;r++)t=s[r],l[l.length-1].push(t),"div"===t.type&&","===t.value&&l.push([]);for(this.oldDirection(l),this.colorStops(l),e.nodes=[],n=0,a=l.length;a>n;n++)u=l[n],e.nodes=e.nodes.concat(u);return e.nodes.unshift({type:"word",value:"linear"},this.cloneDiv(e.nodes)),e.value="-webkit-gradient",!0},r.prototype.oldDirection=function(e){var t,r,n,i,o,a,s;if(t=this.cloneDiv(e[0]),"to"!==e[0][0].value)return e.unshift([{type:"word",value:this.oldDirections.bottom},t]);for(s=[],a=e[0].slice(2),r=0,n=a.length;n>r;r++)i=a[r],"word"===i.type&&s.push(i.value.toLowerCase());return s=s.join(" "),o=this.oldDirections[s]||s,e[0]=[{type:"word",value:o},t]},r.prototype.cloneDiv=function(e){var t,r,n;for(r=0,n=e.length;n>r;r++)if(t=e[r],"div"===t.type&&","===t.value)return t;return{type:"div",value:",",after:" "}},r.prototype.colorStops=function(e){var t,r,n,i,a,s,u,l,c;for(l=[],n=i=0,a=e.length;a>i;n=++i)s=e[n],0!==n&&(t=o.stringify(s[0]),s[1]&&"word"===s[1].type?u=s[1].value:s[2]&&"word"===s[2].type&&(u=s[2].value),c=1!==n||u&&"0%"!==u?n!==e.length-1||u&&"100%"!==u?u?"color-stop("+u+", "+t+")":"color-stop("+t+")":"to("+t+")":"from("+t+")",r=s[s.length-1],e[n]=[{type:"word",value:c}],"div"===r.type&&","===r.value?l.push(e[n].push(r)):l.push(void 0));return l},r.prototype.old=function(e){var n,i,o;return"-webkit-"===e?(o="linear-gradient"===this.name?"linear":"radial",i="-gradient",n=s.regexp("-webkit-("+o+"-gradient|gradient\\(\\s*"+o+")",!1),new t(this.name,e+this.name,i,n)):r.__super__.old.apply(this,arguments)},r.prototype.add=function(e,t){var n;if(n=e.prop,-1!==n.indexOf("mask")){if("-webkit-"===t||"-webkit- old"===t)return r.__super__.add.apply(this,arguments)}else{if("list-style"!==n&&"list-style-image"!==n&&"content"!==n)return r.__super__.add.apply(this,arguments);if("-webkit-"===t||"-webkit- old"===t)return r.__super__.add.apply(this,arguments)}},r}(r),module.exports=e}).call(this);