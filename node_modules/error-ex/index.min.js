"use strict";var util=require("util"),isArrayish=require("is-arrayish"),errorEx=function(t,e){t&&t.constructor===String||(e=t||{},t=Error.name);var n=function r(i){if(!this)return new r(i);i=i instanceof Error?i.message:i||this.message,Error.call(this,i),Error.captureStackTrace(this,n),this.name=t,delete this.message,Object.defineProperty(this,"message",{configurable:!0,enumerable:!1,get:function(){var t=i.split(/\r?\n/g);for(var n in e)e.hasOwnProperty(n)&&"message"in e[n]&&(t=e[n].message(this[n],t)||t,isArrayish(t)||(t=[t]));return t.join("\n")},set:function(t){i=t}});var o=Object.getOwnPropertyDescriptor(this,"stack"),s=o.get;o.get=function(){var t=s.call(this).split(/\r?\n+/g),n=1;for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if("line"in i){var o=i.line(this[r]);o&&t.splice(n,0,"    "+o)}"stack"in i&&i.stack(this[r],t)}return t.join("\n")},Object.defineProperty(this,"stack",o)};return util.inherits(n,Error),n};errorEx.append=function(t,e){return{message:function(n,r){return n=n||e,n&&(r[0]+=" "+t.replace("%s",n.toString())),r}}},errorEx.line=function(t,e){return{line:function(n){return n=n||e,n?t.replace("%s",n.toString()):null}}},module.exports=errorEx;