process.env.OBJECT_IMPL&&(global.TYPED_ARRAY_SUPPORT=!1);var B=require("../").Buffer,test=require("tape");test("detect utf16 surrogate pairs",function(e){var t="😸💭👍",r=new B(t);e.equal(t,r.toString()),e.end()}),test("detect utf16 surrogate pairs over U+20000 until U+10FFFF",function(e){var t="𠮷񟒭􏿿",r=new B(t);e.equal(t,r.toString()),e.end()}),test("replace orphaned utf16 surrogate lead code point",function(e){var t="😸�👍",r=new B(t);e.deepEqual(r,new B([240,159,152,184,239,191,189,240,159,145,141])),e.end()}),test("replace orphaned utf16 surrogate trail code point",function(e){var t="😸�👍",r=new B(t);e.deepEqual(r,new B([240,159,152,184,239,191,189,240,159,145,141])),e.end()}),test("do not write partial utf16 code units",function(e){var t=new B([0,0,0,0,0]);e.equal(t.length,5);var r=t.write("あいうえお","utf16le");e.equal(r,4),e.deepEqual(t,new B([66,48,68,48,0])),e.end()}),test("handle partial utf16 code points when encoding to utf8 the way node does",function(e){var t="😸👍",r=new B(8);r.fill(0),r.write(t),e.deepEqual(r,new B([240,159,152,184,240,159,145,141])),r=new B(7),r.fill(0),r.write(t),e.deepEqual(r,new B([240,159,152,184,0,0,0])),r=new B(6),r.fill(0),r.write(t),e.deepEqual(r,new B([240,159,152,184,0,0])),r=new B(5),r.fill(0),r.write(t),e.deepEqual(r,new B([240,159,152,184,0])),r=new B(4),r.fill(0),r.write(t),e.deepEqual(r,new B([240,159,152,184])),r=new B(3),r.fill(0),r.write(t),e.deepEqual(r,new B([0,0,0])),r=new B(2),r.fill(0),r.write(t),e.deepEqual(r,new B([0,0])),r=new B(1),r.fill(0),r.write(t),e.deepEqual(r,new B([0])),e.end()}),test("handle invalid utf16 code points when encoding to utf8 the way node does",function(e){var t="a��b",r=new B(8);r.fill(0),r.write(t),e.deepEqual(r,new B([97,239,191,189,239,191,189,98])),r=new B(7),r.fill(0),r.write(t),e.deepEqual(r,new B([97,239,191,189,239,191,189])),r=new B(6),r.fill(0),r.write(t),e.deepEqual(r,new B([97,239,191,189,0,0])),r=new B(5),r.fill(0),r.write(t),e.deepEqual(r,new B([97,239,191,189,0])),r=new B(4),r.fill(0),r.write(t),e.deepEqual(r,new B([97,239,191,189])),r=new B(3),r.fill(0),r.write(t),e.deepEqual(r,new B([97,0,0])),r=new B(2),r.fill(0),r.write(t),e.deepEqual(r,new B([97,0])),r=new B(1),r.fill(0),r.write(t),e.deepEqual(r,new B([97])),e.end()});